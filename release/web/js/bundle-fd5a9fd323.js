(()=>{var e,t,i,s,a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=(e,t,i,s)=>{for(var o,l=s>1?void 0:s?n(t,i):t,d=e.length-1;d>=0;d--)(o=e[d])&&(l=(s?o(t,i,l):o(l))||l);return s&&l&&a(t,i,l),l},l=(e,t,i)=>new Promise((s,a)=>{var n=e=>{try{l(i.next(e))}catch(e){a(e)}},o=e=>{try{l(i.throw(e))}catch(e){a(e)}},l=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);l((i=i.apply(e,t)).next())});!function(e){e.load_progress="load_progress",e.update_field="update_field",e.update_Order="update_Order",e.land_speed_up="land_speed_up",e.login_game="login_game",e.login_out="login_out",e.update_task="update_task",e.update_guid_hand="update_guid_hand",e.play_get_reward="play_get_reward",e.play_ad_get_reward="play_ad_get_reward",e.go_friend_home="go_friend_home"}(e||(e={})),function(e){e.ad="ad",e.closeImage="closeImage",e.wxLogin="wxLogin",e.wxLoginSuccess="wxLoginSuccess",e.wxShare="wxShare",e.eventCount="eventCount",e.privacyAgreement="privacyAgreement",e.serviceAgreement="serviceAgreement",e.registerSuccess="registerSuccess",e.loginSuccess="LoginSuccess",e.clearCache="clearCache",e.showBackground="showBackground"}(t||(t={})),function(e){e.AboutView="scenes/views/AboutView.scene",e.AddLandView="scenes/views/AddLandView.scene",e.BuyVitalityView="scenes/views/BuyVitalityView.scene",e.FieldLevelUpView="scenes/views/FieldLevelUpView.scene",e.FriendsDescView="scenes/views/FriendsDescView.scene",e.FriendsRewardView="scenes/views/FriendsRewardView.scene",e.FriendsView="scenes/views/FriendsView.scene",e.GuideView="scenes/views/GuideView.scene",e.HintView="scenes/views/HintView.scene",e.LoginView="scenes/views/LoginView.scene",e.MailDescView="scenes/views/MailDescView.scene",e.MailView="scenes/views/MailView.scene",e.MainView="scenes/views/MainView.scene",e.OrderView="scenes/views/OrderView.scene",e.OverView="scenes/views/OverView.scene",e.SettingView="scenes/views/SettingView.scene",e.ShopView="scenes/views/ShopView.scene",e.SignInView="scenes/views/SignInView.scene",e.SpeedUpView="scenes/views/SpeedUpView.scene",e.TaskView="scenes/views/TaskView.scene",e.WarehouseView="scenes/views/WarehouseView.scene"}(i||(i={})),function(e){e.zhongzhi="res/audio/zhongzhi.mp3",e.tudishengji="res/audio/tudishengji.mp3",e.shoucai="res/audio/shoucai.mp3",e.goujiaosheng="res/audio/goujiaosheng.mp3",e.dakaicangku="res/audio/dakaicangku.mp3",e.button_click="res/audio/button_click.mp3",e.BGM="res/audio/BGM.mp3"}(s||(s={}));var d={views:i,scenes:["scenes/views/WarehouseView.scene","scenes/views/TaskView.scene","scenes/views/SpeedUpView.scene","scenes/views/SignInView.scene","scenes/views/ShopView.scene","scenes/views/SettingView.scene","scenes/views/OverView.scene","scenes/views/OrderView.scene","scenes/views/MainView.scene","scenes/views/MailView.scene","scenes/views/MailDescView.scene","scenes/views/LoginView.scene","scenes/views/HintView.scene","scenes/views/GuideView.scene","scenes/views/FriendsView.scene","scenes/views/FriendsRewardView.scene","scenes/views/FriendsDescView.scene","scenes/views/FieldLevelUpView.scene","scenes/views/BuyVitalityView.scene","scenes/views/AddLandView.scene","scenes/views/AboutView.scene","scenes/prefab/MailItem.prefab","scenes/prefab/GetReward.prefab","scenes/prefab/FloatRewardIcon.prefab","scenes/prefab/FieldPrefab.prefab","scenes/components/Button.prefab","scenes/ani/landUp.ani","res/loadingBg.png","res/img_woodtitle.png","res/img_storeHouseBg.png","res/img_storebg.png","res/img_shelf.png","res/img_popUpBgMain.png","res/img_popUpBg.png","res/img_landBg.png","res/img_inviteBg1.png","res/img_housetop.png","res/img_hongbaoban.png","res/img_homepageBg3.png","res/img_homepageBg2.png","res/img_homepageBg1.png","res/img_farmlandLogo.png","res/figure5.png","res/figure5.atlas","res/figure4.png","res/figure4.atlas","res/figure3.png","res/figure3.atlas","res/figure2.png","res/figure2.atlas","res/figure1.png","res/figure1.atlas","res/figure.png","res/figure.atlas","res/shader/vs.vs","res/shader/ps.fs","res/audio/zhongzhi.mp3","res/audio/tudishengji.mp3","res/audio/shoucai.mp3","res/audio/goujiaosheng.mp3","res/audio/dakaicangku.mp3","res/audio/button_click.mp3","res/audio/BGM.mp3","res/atlas/plant_icon.png","res/atlas/plant_icon.atlas","res/atlas/pet_feed.png","res/atlas/pet_feed.atlas","res/atlas/main_scene.png","res/atlas/main_scene.atlas","res/atlas/load.png","res/atlas/load.atlas","res/atlas/game.png","res/atlas/game.atlas"],audios:s},c=new Laya.EventDispatcher,r=new Map;var h=new Map;var u=c,p=new Map,m=new class{constructor(){this.keyEvents=new Map}watch(e,t){p.has(t)||p.set(t,[]);let i=this.keyEvents;i.has(e)||i.set(e,new Map);const s=(a,n)=>{let o=i.get(e);return o.has(a)||(o.set(a,[]),null==e["#"+a]&&(e["#"+a]=e[a],Object.defineProperty(e,a,{configurable:!1,enumerable:!1,set:function(e){this["#"+a]=e,o.get(a).forEach(t=>{t(e)})},get:function(){return this["#"+a]}}))),o.get(a).push(n),p.get(t).push(n),n(e[a]),{key:s}};return{key:s}}removeByCaller(e,t=null){var i;null==(i=p.get(e))||i.forEach(e=>{var i,s;t?null==(i=this.keyEvents)||i.get(t).forEach(t=>{let i=t.indexOf(e);i>-1&&t.splice(i,1)}):null==(s=this.keyEvents)||s.forEach(t=>{t.forEach(t=>{let i=t.indexOf(e);i>-1&&t.splice(i,1)})})})}},g=class extends Laya.Script{constructor(){super();let e=r.get(this.constructor.prototype);null==e||e.forEach(e=>{u.on(e.key,this,e.fn)})}onAwake(){var e;null==(e=h.get(this.constructor.prototype))||e.forEach(e=>{this[e]=this.owner.getChildByName(e)}),this.onHdAwake()}onOpened(e){}onHdAwake(){}onEnable(){this.onHdEnable()}onHdEnable(){}onStart(){this.onHdStart()}onHdStart(){}onUpdate(){this.onHdUpdate()}onHdUpdate(){}onDisable(){this.onHdDisable()}onHdDisable(){}onDestroy(){u.offAllCaller(this),this.onHdDestroy(),Laya.timer.once(1,null,()=>{m.removeByCaller(this);let e=Object.getOwnPropertyNames(this);for(let t=0,i=e.length;t<i;t++)this[e[t]]=null})}onHdDestroy(){}},v=class extends g{constructor(){super(...arguments),this.bg=null,this.content=null,this.tweenList=[]}doOpen(){}doClose(){}onEnable(){let e=this.owner;switch(this.bg.alpha=0,this.tweenList.push(Laya.Tween.to(this.bg,{alpha:.75},100,null,Laya.Handler.create(this,this.doOpen,[e]),0,!1,!1)),this.aniType){case"scaleShow":this.content.scale(1,1),this.tweenList.push(Laya.Tween.from(this.content,{x:Laya.stage.width/2,y:Laya.stage.height/2,scaleX:0,scaleY:0},300,Laya.Ease.backOut,Laya.Handler.create(this,this.doOpen,[e]),0,!1,!1));break;default:this.content.bottom=-this.content.height,this.tweenList.push(Laya.Tween.to(this.content,{bottom:0},300,Laya.Ease.circOut,Laya.Handler.create(this,this.doOpen,[e]),0,!1,!1))}}closeView(){let e=this.owner;return new Promise(t=>{switch(this.tweenList.push(Laya.Tween.to(this.bg,{alpha:0},200,null,Laya.Handler.create(this,this.doOpen,[e]),0,!1,!1)),this.aniType){case"scaleShow":this.tweenList.push(Laya.Tween.to(this.content,{x:Laya.stage.width/2,y:Laya.stage.height/2,scaleX:.5,scaleY:.5,alpha:0},150,null,new Laya.Handler(this,()=>{this.doClose(),t(null)},[e]),0,!1,!1));break;default:this.tweenList.push(Laya.Tween.to(this.content,{bottom:-this.content.height},200,null,new Laya.Handler(this,()=>{this.doClose(),t(null)},[e]),0,!1,!1))}})}onDisable(){this.tweenList.forEach(e=>{Laya.Tween.clear(e)}),this.tweenList.length=0}},w=new Map,y=100;function Instance(e,t){w.has(e["#instanceId"])||(y++,e["#instanceId"]=y,w.set(y,new e)),e[t]=w.get(y)}var b,k=[],f=class{loginOut(){k.forEach(e=>{e.view.getComponents(Laya.Script).forEach(e=>{Laya.timer.clearAll(e),e.destroy()}),this.closeViewLog(e.view.url,!0),e.view.destroy(!0)}),k.length=0}open(e,t={closeOther:!1,showLoad:!1,showLoadDelay:100,hideLoadDelay:0}){e?(t.showLoad&&(Laya.View.showLoadingPage(null,t.showLoadDelay),e!==d.views.LoginView&&Laya.timer.frameOnce(1,this,()=>{Laya.View.hideLoadingPage(t.hideLoadDelay)})),t.closeOther=!1,Laya.View.open(e,t.closeOther,t.parm,Laya.Handler.create(this,i=>{e!=d.views.LoginView&&k.push({url:e,view:i});let s=i.getComponents(Laya.Script);s&&s.forEach(e=>e.enabled&&e.onOpened&&e.onOpened(t.parm)),t.complete&&t.complete(i),console.log(`%c ==> open %c${e.match(/\w+(?=\.)/)[0]} `,"color:#7ed6df;font-weight:700;background-color:#dff9fb","color:#22a6b3;font-weight:700;background-color:#dff9fb")}),t.progress)):console.warn("miss path!")}close(e){return l(this,arguments,function*(e,t=!1,i=!1,s=v){let a;for(let i=k.length-1;i>-1;i--)if(e===k[i].url){let n=k[i];if(k.splice(i,1),(a=n.view.getComponent(s))?a.closeView().then(()=>{n.view.destroy(!0),this.closeViewLog(e,!0)}):(n.view.destroy(!0),this.closeViewLog(e,!0)),e===d.views.HintView)return;if(!t)break}if(!k.length)return;let n=0;for(let e=k.length-1;e>-1;e--)k[e].view.parent||n++;n===k.length&&(k.length=0,this.open(d.views.MainView)),console.log(k)})}closeViewLog(e,t=!1){console.log(`%c <== ${t?"destroy":"disable"} %c${e.match(/\w+(?=\.)/)[0]} `,"color:#ff7979;font-weight:700;background-color:#dff9fb","color:#eb4d4b;font-weight:700;background-color:#dff9fb")}openHint(e){this.open(d.views.HintView,{parm:e})}clearViewMaps(){k.length=0}setOverView(e,t){e?this.open(d.views.OverView,{parm:{call:e=>{this.overViewCom=e,e.close(t)}}}):this.overViewCom&&this.overViewCom.open(t)}};o([Instance],f,"inst",2),function(e){e.test="test",e.online="online",e.debug="debug"}(b||(b={}));var L={diamondId:1001,goldId:1002,petDigestIntervalTime:60,localKey:"love_HD_farm",userVitalityLimit:10,baseUrl:"test"==b.debug?"//192.168.101.50:3000":"http://game.ahd168.com:3000",ApiTypeDefault:1,ApiTypeAD:2,ADSpeedUpTimes:6,version:"1.0.0"},_=new Map,B=class{static runAppFunction(e){if(Laya.Browser.onIOS);else if(console.log(JSON.stringify(e)),window.$App&&window.$App.webRequest)return new Promise(t=>{window.$App.webRequest(JSON.stringify(e)),console.log(`send => ${e}`),e.timestamp&&_.set(e.timestamp,t)})}static listenAppFunction(){window.appResponse=(e=>{_.has(null==e?void 0:e.timestamp)&&!e.code&&_.get(e.timestamp)(e),console.log(e)})}};B.typeIos=1,B.typeAndroid=2;var S={observableProperty:m,view:f.inst,gameScript:g,instance:Instance,eventOn:function(e){return(t,i,s)=>{r.get(t)||r.set(t,[]),r.get(t).push({key:e,fn:s.value})}},findByName:function(e,t){h.has(e)||h.set(e,[]),h.get(e).push(t)},eventGlobal:u,audio:new class{playSound(e,t,i,s,a){Laya.SoundManager.playSound(e,t,i,s,a)}playMusic(e,t=0,i,s){Laya.SoundManager.playMusic(e,t,i,s)}set soundMuted(e){Laya.SoundManager.soundMuted=e}get soundMuted(){return Laya.SoundManager.soundMuted}set musicMuted(e){Laya.SoundManager.musicMuted=e}get musicMuted(){return Laya.SoundManager.musicMuted}}},I=class extends S.gameScript{constructor(){super(...arguments),this.version=null}onOpened(){this.version.text=`版本号：V${L.version}`}onClick(e){switch(e.target.name){case"close":S.view.close(d.views.AboutView);break;case"user_agreement":B.runAppFunction({uri:t.serviceAgreement,data:{}});break;case"privacy":B.runAppFunction({uri:t.privacyAgreement,data:{}})}}},x=class extends Laya.Script{constructor(){super(...arguments),this.isScale=!1,this.scaleVal=.9}onEnable(){this.owner.mouseEnabled=!0,this.oldScaleX=this.owner.get_scaleX(),this.oldScaleY=this.owner.get_scaleY()}onClick(){S.audio.playSound(d.audios.button_click)}onMouseDown(){this.setSkin(this.downRes),this.setAni(this.scaleVal)}onMouseOut(){this.setSkin(this.defaultRes),this.setAni(1)}onMouseUp(){this.setSkin(this.defaultRes),this.setAni(1)}setAni(e){this.isScale&&Laya.Tween.to(this.owner,{scaleX:e*this.oldScaleX,scaleY:e*this.oldScaleY},300,Laya.Ease.backOut,null,0,!1,!1)}setSkin(e){e&&(this.owner.skin=e)}onDisable(){}},C={isLogin:!1,token:null,sound:!1,music:!1,version:"0.0.0"},D=new class{constructor(){this.localData=C}init(){this.localData=Laya.LocalStorage.getJSON(L.localKey)||C}getJSON(){return this.localData}setJSON(e,t){this.localData[e]=t,Laya.LocalStorage.setJSON(L.localKey,this.localData)}clear(){Laya.LocalStorage.setJSON(L.localKey,{version:this.localData.version}),this.localData={isLogin:!1,token:null,sound:!0,music:!0,version:this.localData.version}}},T={task:[{id:1001,reward:"1001:50",times:1,title:"签到领钻石",desc:"看视频签到",icon:null},{id:1002,reward:"1001:100",times:10,title:"菜地施肥10次",desc:"菜地加速10次",icon:null},{id:1003,reward:"1001:50",times:10,title:"菜地收获10次",desc:"菜地收获10次",icon:null},{id:1004,reward:"1001:50",times:5,title:"访友5次",desc:"偷菜5次",icon:null},{id:1005,reward:"1001:20",times:3,title:"喂养狗狗3次",desc:"喂养狗狗3次",icon:null},{id:1006,reward:"1001:20",times:5,title:"购买饲料5次",desc:"购买饲料5次",icon:null},{id:1007,reward:"1001:20",times:10,title:"购买种子10次",desc:"购买种子10次",icon:null},{id:1008,reward:"1002:500",times:3,title:"出售作物3次",desc:"出售作物3次",icon:null},{id:1009,reward:"1001:100",times:5,title:"添加好友",desc:"添加好友5个",icon:null},{id:1010,reward:"1001:50",times:1,title:"分享得好礼",desc:"分享一次",icon:null},{id:1011,reward:"1002:500",times:3,title:"指定种植",desc:"种植指定种子",icon:null},{id:1012,reward:"1001:50",times:10,title:"看视频领福利",desc:"看视频10次",icon:null}],signIn:[{id:1001,days:7,reward:"1001:20000"},{id:1002,days:10,reward:"1001:30000"},{id:1003,days:15,reward:"1001:50000"},{id:1004,days:20,reward:"1001:80000"},{id:1005,days:30,reward:"1001:120000"},{id:1006,days:50,reward:"1001:180000"},{id:1007,days:80,reward:"1001:300000"},{id:1008,days:100,reward:"1001:350000"},{id:1009,days:150,reward:"1001:500000"}],plant:[{id:1001,name:"水稻",icon:"plant_icon/1002_seed.png",seed_price:"1002:50",gain:"1001:0,1002:50",harvest:"1~2",mature_time:"180",unlock_cost:null,unlock_reward:null,desc:"种下一粒种子，收获整个世界"},{id:1002,name:"大豆",icon:"plant_icon/1004_seed.png",seed_price:"1002:50",gain:"1001:0,1002:50",harvest:"1~2",mature_time:"180",unlock_cost:null,unlock_reward:null,desc:"种下一粒种子，收获整个世界"},{id:1003,name:"大蒜",icon:"plant_icon/1012_seed.png",seed_price:"1002:50",gain:"1001:0,1002:50",harvest:"1~2",mature_time:"240",unlock_cost:null,unlock_reward:null,desc:"种下一粒种子，收获整个世界"},{id:1004,name:"包心菜",icon:"plant_icon/1006_seed.png",seed_price:"1002:75",gain:"1001:0,1002:75",harvest:"1~2",mature_time:"300",unlock_cost:"1002:1000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1005,name:"土豆",icon:"plant_icon/1007_seed.png",seed_price:"1002:75",gain:"1001:0,1002:75",harvest:"2~3",mature_time:"300",unlock_cost:"1002:1000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1006,name:"萝卜",icon:"plant_icon/1005_seed.png",seed_price:"1002:75",gain:"1001:0,1002:75",harvest:"2~3",mature_time:"480",unlock_cost:"1002:1000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1007,name:"小麦",icon:"plant_icon/1001_seed.png",seed_price:"1002:120",gain:"1001:0,1002:120",harvest:"2~3",mature_time:"480",unlock_cost:"1002:1500",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1008,name:"辣椒",icon:"plant_icon/1010_seed.png",seed_price:"1002:120",gain:"1001:0,1002:120",harvest:"2~3",mature_time:"600",unlock_cost:"1002:2000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1009,name:"黄瓜",icon:"plant_icon/1011_seed.png",seed_price:"1002:200",gain:"1001:0,1002:200",harvest:"3~4",mature_time:"720",unlock_cost:"1002:3000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1010,name:"茄子",icon:"plant_icon/1013_seed.png",seed_price:"1002:200",gain:"1001:0,1002:200",harvest:"3~4",mature_time:"720",unlock_cost:"1002:3500",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1011,name:"胡萝卜",icon:"plant_icon/1008_seed.png",seed_price:"1002:350",gain:"1001:0,1002:350",harvest:"3~4",mature_time:"900",unlock_cost:"1002:4500",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1012,name:"南瓜",icon:"plant_icon/1014_seed.png",seed_price:"1002:350",gain:"1001:0,1002:350",harvest:"3~4",mature_time:"900",unlock_cost:"1002:5000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1013,name:"玉米",icon:"plant_icon/1003_seed.png",seed_price:"1002:500",gain:"1001:0,1002:500",harvest:"3~5",mature_time:"1200",unlock_cost:"1002:5500",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1014,name:"甘蔗",icon:"plant_icon/1015_seed.png",seed_price:"1002:500",gain:"1001:0,1002:500",harvest:"3~5",mature_time:"1200",unlock_cost:"1002:6000",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"},{id:1015,name:"番茄",icon:"plant_icon/1009_seed.png",seed_price:"1002:500",gain:"1001:0,1002:500",harvest:"3~5",mature_time:"1200",unlock_cost:"1002:6500",unlock_reward:"1001:0,1002:0",desc:"种下一粒种子，收获整个世界"}],pet:[{id:1001,name:"旺财",icon:"pet_feed/1001_dog.png",vitality_max:100,vitality_consume:10,cost:"1002:3000",desc:"爱它就买它~它就是有点懒~",sensitive:34,ability:42},{id:1002,name:"汤圆",icon:"pet_feed/1007_dog.png",vitality_max:100,vitality_consume:15,cost:"1002:4000",desc:"颜值、智商双双在线",sensitive:40,ability:48},{id:1003,name:"肉干",icon:"pet_feed/1009_dog.png",vitality_max:100,vitality_consume:16,cost:"1002:4500",desc:"最忠诚的伙伴",sensitive:45,ability:55},{id:1004,name:"二哈",icon:"pet_feed/1002_dog.png",vitality_max:100,vitality_consume:16,cost:"1002:5000",desc:"绝不拆家！",sensitive:48,ability:60},{id:1005,name:"大眼睛",icon:"pet_feed/1005_dog.png",vitality_max:100,vitality_consume:17,cost:"1002:7000",desc:"活好吃的少",sensitive:50,ability:75},{id:1006,name:"小尾巴",icon:"pet_feed/1004_dog.png",vitality_max:100,vitality_consume:18,cost:"1002:7500",desc:"武力天赋已点满~拿捏！",sensitive:60,ability:80},{id:1007,name:"球球",icon:"pet_feed/1008_dog.png",vitality_max:100,vitality_consume:18,cost:"1002:8000",desc:"就两个字，听话！",sensitive:69,ability:85},{id:1008,name:"小白",icon:"pet_feed/1003_dog.png",vitality_max:100,vitality_consume:18,cost:"1002:8000",desc:"看家、看菜、看孩子",sensitive:76,ability:88},{id:1009,name:"点点",icon:"pet_feed/1006_dog.png",vitality_max:100,vitality_consume:19,cost:"1002:10000",desc:"你值得拥有！",sensitive:85,ability:93},{id:1010,name:"闷墩",icon:"pet_feed/1010_dog.png",vitality_max:100,vitality_consume:30,cost:"1002:15000",desc:"长得就很凶，抓小偷更凶",sensitive:90,ability:99}],order:[{id:1,commission:"1.12",condition:"1001:2"},{id:2,commission:"0.87",condition:"1001:1,1002:2"},{id:3,commission:"0.69",condition:"1001:1,1003:2,1002:3"},{id:4,commission:"0.61",condition:"1002:4,1003:3,1004:3,1001:4"},{id:5,commission:"0.61",condition:"1004:6,1002:5,1005:4,1001:5"},{id:6,commission:"0.68",condition:"1003:10,1004:5,1005:3,1006:3"},{id:7,commission:"0.43",condition:"1007:4,1003:5,1004:7,1006:10"},{id:8,commission:"0.56",condition:"1008:13,1007:3,1005:5,1002:5"},{id:9,commission:"0.39",condition:"1006:2,1009:10,1007:8,1003:8"},{id:10,commission:"0.22",condition:"1006:10,1010:5,1008:10,1009:6"},{id:11,commission:"0.76",condition:"1009:5,1004:10,1001:9,1002:10"},{id:12,commission:"0.43",condition:"1007:6,1003:11,1011:6,1005:10"},{id:13,commission:"0.17",condition:"1010:5,1005:13,1001:8,1012:8"},{id:14,commission:"0.55",condition:"1013:10,1008:8,1006:6,1001:10"},{id:15,commission:"0.48",condition:"1002:10,1005:10,1011:12,1001:10"},{id:16,commission:.29,condition:"1008:11,1014:4,1006:8,1005:17"},{id:17,commission:.37,condition:"1006:14,1007:6,1015:12,1001:14"},{id:18,commission:.48,condition:"1008:14,1011:12,1009:15,1002:5"},{id:19,commission:.75,condition:"1013:10,1003:20,1014:11,1001:7"},{id:20,commission:.67,condition:"1003:10,1011:17,1002:14,1005:12"},{id:21,commission:.64,condition:"1010:10,1003:14,1005:16,1007:15"},{id:22,commission:"0.4",condition:"1015:19,1007:12,1011:5,1004:17"},{id:23,commission:"0.4",condition:"1003:19,1014:22,1015:16,1008:14"},{id:24,commission:.77,condition:"1014:13,1001:17,1008:18,1004:15"},{id:25,commission:"0.39",condition:"1012:23,1011:19,1010:15,1015:20"},{id:26,commission:.03,condition:"1002:21,1011:12,1012:22,1003:19"},{id:27,commission:.49,condition:"1007:16,1014:16,1006:20,1011:17"},{id:28,commission:.53,condition:"1014:17,1007:12,1011:17,1003:17"},{id:29,commission:.77,condition:"1012:10,1005:16,1010:14,1015:18"},{id:30,commission:"0.34",condition:"1011:17,1014:19,1006:14,1004:30"},{id:31,commission:.53,condition:"1007:18,1010:14,1013:19,1006:11"},{id:32,commission:.46,condition:"1013:19,1005:22,1012:12,1008:20"},{id:33,commission:"0.44",condition:"1012:16,1013:20,1002:23,1009:16"},{id:34,commission:"0.42",condition:"1009:19,1010:12,1011:14,1012:20"},{id:35,commission:"0.33",condition:"1001:18,1004:19,1013:16,1003:20"},{id:36,commission:.21,condition:"1003:11,1008:17,1014:17,1007:19"},{id:37,commission:.44,condition:"1012:19,1010:20,1002:14,1011:11"},{id:38,commission:.22,condition:"1014:13,1004:19,1002:11,1015:18"},{id:39,commission:.36,condition:"1007:18,1012:13,1004:16,1002:26"},{id:40,commission:.28,condition:"1004:30,1005:10,1008:18,1011:16"},{id:41,commission:"0.48",condition:"1010:18,1009:18,1008:17,1011:26"},{id:42,commission:.43,condition:"1009:21,1005:18,1007:20,1002:23"},{id:43,commission:"0.24",condition:"1006:30,1004:14,1014:11,1008:15"},{id:44,commission:.62,condition:"1009:15,1003:28,1002:34,1007:19"},{id:45,commission:"0.41",condition:"1012:15,1010:23,1007:13,1011:13"},{id:46,commission:.39,condition:"1003:22,1007:23,1010:16,1002:24"},{id:47,commission:.49,condition:"1010:24,1015:20,1003:25,1014:16"},{id:48,commission:"0.26",condition:"1013:17,1007:24,1008:37,1001:30"},{id:49,commission:.48,condition:"1002:26,1004:21,1009:22,1006:20"},{id:50,commission:"0.25",condition:"1006:27,1012:19,1008:20,1015:11"},{id:51,commission:"0.34",condition:"1011:18,1004:19,1002:25,1003:11"},{id:52,commission:.43,condition:"1015:15,1013:20,1001:25,1004:26"},{id:53,commission:"0.28",condition:"1014:14,1012:12,1010:20,1015:18"},{id:54,commission:.45,condition:"1005:22,1002:33,1009:16,1015:17"},{id:55,commission:"0.56",condition:"1001:23,1014:19,1005:17,1010:15"},{id:56,commission:"0.35",condition:"1006:27,1005:29,1009:17,1003:18"},{id:57,commission:.67,condition:"1007:21,1008:17,1002:16,1009:25"},{id:58,commission:.32,condition:"1006:20,1008:25,1005:24,1007:19"},{id:59,commission:.79,condition:"1012:25,1009:30,1013:16,1008:15"},{id:60,commission:.69,condition:"1015:26,1012:27,1010:31,1001:23"},{id:61,commission:.39,condition:"1015:12,1006:25,1011:15,1002:17"},{id:62,commission:.44,condition:"1015:21,1007:15,1011:18,1006:26"},{id:63,commission:.01,condition:"1010:18,1005:16,1009:13,1003:27"},{id:64,commission:.27,condition:"1007:17,1006:10,1005:29,1004:25"},{id:65,commission:.39,condition:"1008:15,1003:30,1014:20,1005:15"},{id:66,commission:.73,condition:"1004:25,1008:25,1002:34,1012:14"},{id:67,commission:.13,condition:"1001:36,1012:20,1011:20,1003:20"},{id:68,commission:.69,condition:"1013:24,1008:23,1006:16,1007:17"},{id:69,commission:.37,condition:"1015:30,1004:29,1013:17,1009:10"},{id:70,commission:.71,condition:"1010:23,1004:31,1011:17,1012:11"},{id:71,commission:.29,condition:"1008:11,1002:26,1003:28,1015:13"},{id:72,commission:.31,condition:"1005:25,1002:38,1012:19,1010:14"},{id:73,commission:.39,condition:"1012:34,1006:22,1003:27,1004:20"},{id:74,commission:.26,condition:"1003:20,1012:18,1002:30,1001:20"},{id:75,commission:.18,condition:"1006:31,1014:30,1008:12,1002:25"},{id:76,commission:.51,condition:"1007:21,1012:20,1004:11,1014:20"},{id:77,commission:.21,condition:"1008:15,1009:16,1012:24,1007:30"},{id:78,commission:.73,condition:"1015:16,1012:16,1006:20,1008:22"},{id:79,commission:.65,condition:"1006:26,1004:18,1007:12,1011:27"},{id:80,commission:.39,condition:"1009:15,1003:16,1004:19,1007:24"},{id:81,commission:.14,condition:"1012:20,1015:28,1002:24,1003:38"},{id:82,commission:.2,condition:"1005:12,1011:19,1009:18,1002:14"},{id:83,commission:.53,condition:"1010:19,1003:38,1007:22,1015:20"},{id:84,commission:.62,condition:"1005:29,1014:26,1002:18,1007:38"},{id:85,commission:.37,condition:"1011:20,1001:17,1012:12,1004:32"},{id:86,commission:.59,condition:"1009:25,1011:20,1006:14,1015:21"},{id:87,commission:"0.31",condition:"1006:26,1005:19,1013:20,1014:29"},{id:88,commission:"0.48",condition:"1008:37,1011:24,1015:12,1014:11"},{id:89,commission:"0.22",condition:"1002:17,1003:28,1005:22,1010:31"},{id:90,commission:.32,condition:"1002:39,1013:28,1007:25,1001:33"},{id:91,commission:.19,condition:"1008:15,1013:20,1014:10,1007:26"},{id:92,commission:.13,condition:"1004:38,1011:13,1008:15,1007:29"},{id:93,commission:.34,condition:"1013:12,1001:39,1006:38,1008:31"},{id:94,commission:.22,condition:"1002:36,1014:27,1013:16,1005:31"},{id:95,commission:.15,condition:"1005:26,1011:34,1015:34,1008:16"},{id:96,commission:"0.49",condition:"1003:24,1001:34,1007:28,1005:30"},{id:97,commission:"0.6",condition:"1013:32,1009:33,1006:30,1011:40"}],lang:[],landLevel:[{id:1,reward:"1002:0",cost:"1002:0",gain:null},{id:2,reward:"1002:1500",cost:"1002:10000",gain:.1},{id:3,reward:"1002:2000",cost:"1002:30000",gain:.25},{id:4,reward:"1002:2500",cost:"1002:50000",gain:.4},{id:5,reward:"1002:3000",cost:"1002:100000",gain:.55}],feed:[{id:1001,name:"饼干",icon:"pet_feed/1001_feed.png",vitality:1,cost:"1002:30",desc:"可增加宠物&点体力"},{id:1002,name:"坚果",icon:"pet_feed/1002_feed.png",vitality:2,cost:"1002:50",desc:"可增加宠物&点体力"},{id:1003,name:"火腿",icon:"pet_feed/1003_feed.png",vitality:5,cost:"1002:100",desc:"可增加宠物&点体力"},{id:1004,name:"牛肉",icon:"pet_feed/1004_feed.png",vitality:50,cost:"1002:900",desc:"可增加宠物&点体力"},{id:1005,name:"猪肉",icon:"pet_feed/1005_feed.png",vitality:20,cost:"1002:460",desc:"可增加宠物&点体力"},{id:1006,name:"鸡肉",icon:"pet_feed/1006_feed.png",vitality:10,cost:"1002:270",desc:"可增加宠物&点体力"}],currency:[{id:1001,name:"钻石",icon:"main_scene/img_diamond.png"},{id:1002,name:"金币",icon:"main_scene/img_coin.png"}],config:[{id:"all_speed_up_times",value:30},{id:"all_speed_up_time",value:600},{id:"unlock_land_cost",value:"1002:0,1002:0,1002:5000,1002:10000,1002:20000,1002:30000,1002:40000,1002:50000,1002:60000"},{id:"goldDefault",value:"1002:100"},{id:"diamondDefault",value:"1001:50"},{id:"ADTimesLimit",value:30},{id:"ADSpeedUptimes",value:6},{id:"vitalityBuyCostGold",value:"1002:10000"},{id:"vitalityLimit",value:10},{id:"landAmountMax",value:9},{id:"petDefaultVitality",value:100},{id:"petDigestIntervalTime",value:60},{id:"Videorewards",value:"1001:100"},{id:"withdrawal",value:"1001:10000:1"},{id:"Invitation_rewards",value:"1001:5000"},{id:"withdrawal_times",value:"0.3:3,0.5:2,5:0,10:0,50:0"}]},N=class{static parseString(e,t=","){return e?e.split(t):[]}};N.formatSeconds=(e=>new Date(1e3*e).toISOString().substr(11,8));var V={pet:e=>({id:e.id,name:e.name,icon:e.icon||`pet_feed/${e.id}_dog.png`,vitality_max:e.vitality_max,vitality_consume:e.vitality_consume,cost:getRewardCurrencyBase(e.cost),desc:e.desc,sensitive:e.sensitive,ability:e.ability}),feed:e=>({id:e.id,name:e.name,icon:e.icon||`pet_feed/${e.id}_feed.png`,vitality:e.vitality,cost:getRewardCurrencyBase(e.cost),desc:e.desc}),order:e=>({id:e.id,commission:Number(e.commission),condition:N.parseString(e.condition).map(e=>{let t=N.parseString(e,":");return{plant:O.table("plant").get(Number(t[0])),count:Number(t[1])}})}),plant:e=>({id:e.id,name:e.name,icon:e.icon,matureIcon:`plant_icon/${e.icon.match(/\d+/g)[0]}_mature.png`,growingIcon:`plant_icon/${e.icon.match(/\d+/g)[0]}_growing.png`,gain:N.parseString(e.gain).map(e=>getRewardCurrencyBase(e)),desc:e.desc,seed_price:getRewardCurrencyBase(e.seed_price),harvest:Number(N.parseString(e.harvest,"~")[1]),mature_time:Number(e.mature_time),unlock_cost:getRewardCurrencyBase(e.unlock_cost),unlock_reward:N.parseString(e.unlock_reward).map(e=>getRewardCurrencyBase(e))}),currency:e=>({id:e.id,icon:e.icon,name:e.name}),landLevel:e=>({id:e.id,reward:getRewardCurrencyBase(e.reward),cost:getRewardCurrencyBase(e.cost),gain:e.gain}),config(e){switch(e.id){case"all_speed_up_times":return{id:"all_speed_up_times",value:e.value};case"all_speed_up_time":return{id:"all_speed_up_time",value:e.value};case"unlock_land_cost":return{id:"unlock_land_cost",value:N.parseString(e.value).map(e=>getRewardCurrencyBase(e))};case"goldDefault":return{id:"goldDefault",value:getRewardCurrencyBase(e.value).count};case"diamondDefault":return{id:"diamondDefault",value:getRewardCurrencyBase(e.value).count};case"ADTimesLimit":return{id:"ADTimesLimit",value:e.value};case"ADSpeedUptimes":return{id:"ADSpeedUptimes",value:e.value};case"vitalityBuyCostGold":return{id:"vitalityBuyCostGold",value:getRewardCurrencyBase(e.value).count};case"vitalityLimit":return{id:"vitalityLimit",value:e.value};case"landAmountMax":return{id:"landAmountMax",value:e.value};case"petDefaultVitality":return{id:"petDefaultVitality",value:e.value};case"petDigestIntervalTime":return{id:"petDigestIntervalTime",value:e.value};case"Videorewards":return{id:"Videorewards",value:getRewardCurrencyBase(e.value)};case"withdrawal":return{id:"withdrawal",value:N.parseString(e.value,":")};case"Invitation_rewards":return{id:"Invitation_rewards",value:getRewardCurrencyBase(e.value)};case"withdrawal_times":return{id:"withdrawal_times",value:N.parseString(e.value).map(e=>(e=N.parseString(e,":"),{price:Number(e[0]),times:Number(e[1])}))}}},signIn:e=>({id:e.id,days:e.days,reward:getRewardCurrencyBase(e.reward)}),task:e=>({id:e.id,times:e.times,reward:getRewardCurrencyBase(e.reward),desc:e.desc,title:e.title,icon:e.icon||"game/img_barm.png"})};function getRewardCurrencyBase(e){if(!e)return null;let t=N.parseString(e,":");return{obj:O.table("currency").get(Number(t[0])),count:Number(t[1])}}var A,O=new class{constructor(){this.tableCache=new Map}table(e){if(this.tableCache.has(e))return this.tableBack(this.tableCache.get(e));let t=[];return T[e].forEach(i=>{t.push(V[e](i))}),this.tableCache.set(e,t),this.tableBack(t)}tableBack(e){return{list:e,get(t){for(let i=0,s=e.length;i<s;i++)if(e[i].id==t)return e[i];return null}}}},H=O,P=new class{constructor(){this.list=[]}init(e){e.forEach(e=>this.list.push({id:e.id,times:e.times,receive:e.receive,base:H.table("task").get(e.id)}))}getTask(e){for(let t=0;t<this.list.length;t++)if(this.list[t].id==e)return this.list[t];return null}getList(){return this.list.sort((e,t)=>{let i=this.getTask(e.id),s=this.getTask(t.id);return e.id+((null==i?void 0:i.receive)?1e3:1)+((null==i?void 0:i.times)>=e.base.times?100:1e3)-(t.id+((null==s?void 0:s.receive)?1e3:1)+((null==s?void 0:s.times)>=t.base.times?100:1e3))})}taskAddTimes(t){let i=this.getTask(t);i&&(i.times++,S.eventGlobal.event(e.update_task))}clear(){this.list.length=0}},U=new class{constructor(){this.list=new Map}init(e){e.forEach(e=>{this.addLand(e)})}getLand(e){return this.list.get(e)}addLand(e){this.list.set(e.id,e)}clear(){this.list.clear()}},M=new class{constructor(){this.list=[]}init(e){H.table("pet").list.forEach(t=>{this.list.push({base:t,lock:!e.includes(t.id)})})}getUnlockLen(){let e=0;return this.list.forEach(t=>{t.lock||e++}),e}clear(){this.list.length=0}},F=new class{constructor(){this.list=[]}init(e){H.table("plant").list.forEach(t=>{this.list.push({base:t,lock:!e.includes(t.id)})})}getPlant(e){for(let t=this.list.length-1;t>-1;t++)if(this.list[t].base.id==e)return this.list[t];return null}clear(){this.list.length=0}},E=new class{constructor(){this.orderLevel=1,this.nickname="name",this.key=null,this.avatar="",this.diamond=999,this.gold=999,this.advertiseTimes=0,this.signInDays=0,this.signInId=0,this.speedUpTimes=0,this.vitality=0,this.proportion=1e-4,this.guideData=""}get ttt(){return this.orderLevel}set ttt(e){this.orderLevel=e}clear(){this.nickname=""}},R=new class{constructor(){this.list=[]}init(e){e.forEach(e=>{if(!H.table("plant").get(e.id))return console.error("错误的id "+e.id);this.list.push({base:H.table("plant").get(e.id),count:e.amount})})}reduceAmount(t,i){for(let e=0;e<this.list.length;e++)if(this.list[e].base.id==t){this.list[e].count-=i,this.list[e].count<=0&&this.list.splice(e,1);break}S.eventGlobal.event(e.update_Order)}getOne(e){return this.getItem(e)}getItem(e){for(let t=0;t<this.list.length;t++)if(this.list[t].base.id==e)return this.list[t];return null}add(t,i){let s=this.getItem(t);if(s)return s.count+=i,void S.eventGlobal.event(e.update_Order);H.table("plant").get(t)?(this.list.push({base:H.table("plant").get(t),count:i}),S.eventGlobal.event(e.update_Order)):console.warn("错误的id "+t)}clear(){this.list.length=0}};!function(e){e.login="/login",e.loginToken="/login/token",e.orderReward="/order/reward",e.signInReward="/signIn/reward",e.landUnlock="/land/unlock",e.landSow="/land/sow",e.landGather="/land/gather",e.landUpgrade="/land/upgrade",e.landSpeedUp="/land/speedUp",e.seedsUnlock="/seeds/unlock",e.warehouse="/warehouse",e.warehouseSell="/warehouse/sell",e.petBuy="/pet/buy",e.petWear="/pet/wear",e.feedBuy="/feed/buy",e.taskReward="/task/reward",e.neighbor="/neighbor",e.landSteal="/land/steal",e.ad="/ad",e.vitalityBuy="/vitality/buy",e.goHome="/goHome",e.friendDelete="/friend/delete",e.friendAllow="/friend/allow",e.friendApply="/friend/apply",e.friendSearch="/friend/search",e.friendList="/friend/list",e.friendInvitePeople="/friend/invite/people",e.friendInviteList="/friend/invite/list",e.friendInviteReceive="/friend/invite/receive",e.friendVisit="/friend/visit",e.mailList="/mail/list",e.mailRead="/mail/read",e.mailDelete="/mail/delete",e.withdraw="/withdraw",e.configClient="/config/client",e.guide="/guide"}(A||(A={}));var G=new class{forward(e){switch(e.api){case A.login:case A.loginToken:this.login(e.data);break;case A.landSpeedUp:this.updateUserInfo(e.data),this.taskUpdate(1002);break;case A.ad:this.updateUserInfo(e.data),this.taskUpdate(1001);break;case A.landGather:this.updateUserInfo(e.data),this.taskUpdate(1003);break;case A.feedBuy:this.updateUserInfo(e.data),this.taskUpdate(1005),this.taskUpdate(1006);break;case A.landSow:this.updateUserInfo(e.data),this.taskUpdate(1007);break;case A.warehouseSell:this.updateUserInfo(e.data),this.taskUpdate(1008);break;case A.seedsUnlock:case A.landSow:case A.landUnlock:case A.petBuy:case A.vitalityBuy:case A.taskReward:case A.landUpgrade:case A.orderReward:this.updateUserInfo(e.data)}e.resolveEvent&&e.resolveEvent(e.data),S.eventGlobal.event(e.api,e.data)}error(e,t){S.view.openHint({text:`${null==t?void 0:t.message}`,call:()=>{}})}login(e){var t,i,s;e?(F.init(e.seeds),R.init(e.warehouse),E.key=e.userInfo.key,E.diamond=e.userInfo.diamond,E.gold=e.userInfo.gold,E.nickname=e.userInfo.nickname,E.avatar=e.userInfo.avatar,E.orderLevel=e.orderId||0,E.warePetId=null==(t=e.wearPet)?void 0:t.id,E.petVitality=(null==(i=e.wearPet)?void 0:i.vitality)||0,E.digestCountDown=(null==(s=e.wearPet)?void 0:s.digestCountDown)||0,E.advertiseTimes=e.advertiseTimes||0,E.signInDays=e.signInDays||0,E.signInId=e.signInId,E.speedUpTimes=e.speedUpTimes,E.vitality=e.userInfo.vitality,E.invitePeople=e.userInfo.invitePeople,E.isFirstTime=e.userInfo.isFirstTime,E.guideData=e.userInfo.guideData||"",E.withdraw=e.withdraw,M.init(e.pets),P.init(e.tasks),D.setJSON("isLogin",!0),e.token&&D.setJSON("token",e.token),U.init(e.lands),S.audio.soundMuted=D.getJSON().sound,S.audio.musicMuted=D.getJSON().music):S.view.openHint({text:"登录错误,请重试",call:()=>{}})}loginOut(){F.clear(),R.clear(),M.clear(),U.clear(),P.clear(),D.setJSON("isLogin",!1),D.setJSON("token",null),E.key=null,E.diamond=0,E.gold=0,E.nickname="",E.avatar="",E.orderLevel=0,E.warePetId=null,E.petVitality=0,E.digestCountDown=0,E.advertiseTimes=0,E.signInDays=0,E.signInId=null,E.speedUpTimes=0,E.vitality=0,E.invitePeople=null,E.isFirstTime=null,E.withdraw=[],E.guideData=""}updateUserInfo(e){E.gold=e.gold,E.diamond=e.diamond,E.advertiseTimes=e.advertiseTimes||0}taskUpdate(e){P.taskAddTimes(e)}},$=class{constructor(){this.baseUrl=null,this.eventMap=new Map}init(e){this.baseUrl=e}createXhr(e,t,i){let s=new XMLHttpRequest;return s.onreadystatechange=(()=>{if(4==s.readyState)switch(s.status){case 200:case 201:const a=JSON.parse(s.responseText);a.code||i&&(P.taskAddTimes(1001),P.taskAddTimes(1012)),this.completeHandler(a,e,t),this.clearOneInEventMap(s);break;default:if(s.responseText){let i=JSON.parse(s.responseText);i.statusCode?S.view.openHint({text:`${s.responseText} 请重试`,call:()=>{}}):(i.code=999,this.completeHandler(i,e,t)),this.clearOneInEventMap(s)}s.status||(this.completeHandler({code:404,data:{message:"服务器未响应，请重试"},uri:""},e,t),this.clearOneInEventMap(s))}}),s}clearOneInEventMap(e){Laya.timer.frameOnce(1,this,()=>{this.eventMap.forEach((t,i)=>{t==e&&this.eventMap.delete(i)})})}send(e){return l(this,null,function*(){var i;e.method||(e.method="post"),e.responseType||(e.responseType="json"),e.baseUrl||(e.baseUrl=this.baseUrl);let s=e.baseUrl+e.api,a=[];e.data&&Object.keys(e.data).forEach(t=>{a.push(`${t}=${e.data[t]}`)});const n=a.join("&");if(this.eventMap.get(s+n))return;let o=!1;return(null==(i=e.data)?void 0:i.type)==L.ApiTypeAD&&(yield B.runAppFunction({uri:t.ad,data:{},timestamp:Date.now()}),o=!0),new Promise((t,i)=>l(this,null,function*(){const a=this.createXhr(t,i,o);this.sendData=e,(null==e?void 0:e.before)&&e.before(),e.headers||(e.headers=["Authorization",`Bearer ${D.getJSON().token}`]),console.log(`%c ==> send %c${e.api} %c${JSON.stringify(e.data)}`,"color:#82ccdd;font-weight:700;","color:#eb4d4b;font-weight:700;","color:#f8c291;font-weight:700;"),e.api?(a.open("POST",s,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.setRequestHeader("Authorization",`Bearer ${D.getJSON().token}`),a.send(n),this.eventMap.set(s+n,a)):S.view.open(d.views.HintView,{parm:{text:"http 地址不能为空"}})}))})}completeHandler(e,t,i){var s;if(e.code)return i(e.code),(null==(s=this.sendData)?void 0:s.error)&&this.sendData.error(e.code,e.data),G.error(e.code,e.data),console.error(e);console.log(`%c <== back %c${this.sendData.api} `,"color:#b8e994;font-weight:700;","color:#78e08f;font-weight:700;",e.data),0===e.code&&G.forward({api:this.sendData.api,data:e.data,resolveEvent:t})}errorHandler(e){console.log(e)}processHandler(e){console.log(e)}};o([Instance],$,"inst",2);var j,J=class extends g{constructor(){super(...arguments),this.costIcon=null,this.costFont=null}onOpened(e){this.data=e,this.landData=H.table("config").get("unlock_land_cost").value[U.list.size],this.costIcon.skin=this.landData.obj.icon,this.costFont.value=this.landData.count+""}onClick(t){switch(t.target.name){case"closeAddLandLayer":S.view.close(d.views.AddLandView);break;case"cost_gold":if(this.landData.obj.id==L.goldId&&this.landData.count>E.gold)return void S.view.openHint({text:"金币不足",call:()=>{}});if(this.landData.obj.id==L.diamondId&&this.landData.count>E.diamond)return void S.view.openHint({text:"钻石不足",call:()=>{}});$.inst.send({api:A.landUnlock,data:{landId:this.data.id,type:L.ApiTypeDefault}}).then(()=>{var e;(null==(e=this.data)?void 0:e.call)&&(this.data.call(),S.view.close(d.views.AddLandView))});break;case"ad_btn":$.inst.send({api:A.landUnlock,data:{landId:this.data.id,type:L.ApiTypeAD}}).then(()=>{var i;(null==(i=this.data)?void 0:i.call)&&(this.data.call(),S.view.close(d.views.AddLandView)),S.eventGlobal.event(e.play_ad_get_reward,t.target)})}}},W=class extends g{constructor(){super(...arguments),this.priceLabel=null,this.priceIcon=null}onOpened(e){this.data=e;let t=H.table("config").get("vitalityBuyCostGold").value;this.costGoldCount=t,this.priceLabel.text=`价格：${t}`}onClick(e){switch(e.target.name){case"closeAddLandLayer":S.view.close(d.views.BuyVitalityView);break;case"buyAdBtn":case"buyBtn":if(E.vitality>=H.table("config").get("vitalityLimit").value)return void S.view.openHint({text:"体力已满",call:()=>{}});if("buyBtn"==e.target.name&&E.gold<this.costGoldCount)return void S.view.openHint({text:"金币不足",call:()=>{}});$.inst.send({api:A.vitalityBuy,data:{type:"buyBtn"==e.target.name?L.ApiTypeDefault:L.ApiTypeAD}}).then(e=>{var t;E.vitality=e.vitality,(null==(t=this.data)?void 0:t.call)&&this.data.call(),S.view.close(d.views.BuyVitalityView)})}}},X=class extends g{constructor(){super(...arguments),this.priceLabel=null,this.priceIcon=null}onOpened(e){this.data=e;let t=H.table("landLevel").get(e.obj.level+1);this.priceLabel.text=`价格：${t.cost.count}`,this.priceIcon.skin=t.cost.obj.icon,console.log(e)}onClick(t){switch(t.target.name){case"closeAddLandLayer":S.view.close(d.views.FieldLevelUpView);break;case"upgradeBtn":case"upgradeAdBtn":$.inst.send({api:A.landUpgrade,data:{landId:this.data.obj.id,type:"upgradeBtn"==t.target.name?L.ApiTypeDefault:L.ApiTypeAD}}).then(()=>{"upgradeAdBtn"==t.target.name&&S.eventGlobal.event(e.play_ad_get_reward,t.target),this.data.call&&this.data.call(),S.view.close(d.views.FieldLevelUpView)})}}},z=class extends S.gameScript{onHdAwake(){this.panelNode.vScrollBarSkin=null}onClick(e){switch(e.target.name){case"close":S.view.close(d.views.FriendsDescView)}}onHdDestroy(){Laya.loader.clearTextureRes("res/img_inviteBg1.png")}},K=class extends S.gameScript{constructor(){super(...arguments),this.inviteList=[],this.rewardValue=0,this.proportion=0,this.canClick=!0}onHdAwake(){this.priceList.vScrollBarSkin=null,this.priceList.array=new Array(3),this.priceList.renderHandler=new Laya.Handler(this,this.renderItem)}onOpened(e){this.inviteList=e.list||[],this.call=e.call,E.invitePeople&&(this.inviteBox.visible=!1,this.inviteBox.active=!1),this.rewardValue=H.table("config").get("Invitation_rewards").value.count;const t=H.table("config").get("withdrawal").value;this.proportion=Number(t[1])}onClick(e){switch(e.target.name){case"close":S.view.close(d.views.FriendsRewardView);break;case"invite_btn":B.runAppFunction({uri:t.wxShare,data:{},timestamp:Date.now()});break;case"submit":this.submit();break;case"btn":const i=e.target.dataSource;this.withdraw(i)}}withdraw(e){this.canClick&&(this.canClick=!1,$.inst.send({api:A.friendInviteReceive,data:{index:e}}).then(()=>{this.canClick=!0,S.view.openHint({text:"提现成功",call:()=>{}}),this.inviteList[e].receivedReward=1,this.priceList.refresh()}).catch(()=>{this.canClick=!0}))}renderItem(e,t){e.getChildByName("top").text=`第${t+1}位`;const i=e.getChildByName("btn");e.getChildByName("price_box").getChildByName("price").text=`${this.rewardValue/this.proportion}`,i.skin="game/img_extractActive.png",this.inviteList.length>t?this.inviteList[t].receivedReward?(i.disabled=!0,i.skin="game/img_cashDone.png"):i.disabled=!1:i.disabled=!0,i.dataSource=t}submit(){this.inviteInput.text&&this.inviteInput.text.length?this.canClick&&(this.canClick=!1,$.inst.send({api:A.friendInvitePeople,data:{key:this.inviteInput.text}}).then(()=>{E.invitePeople=this.inviteInput.text,S.view.openHint({text:"绑定成功",call:()=>{}}),this.inviteBox.visible=!1,this.inviteBox.active=!1,this.canClick=!0,this.call&&this.call()}).catch(()=>{this.canClick=!0})):S.view.openHint({text:"邀请码不能为空！",call:()=>{}})}onHdDestroy(){}},Q=class extends S.gameScript{constructor(){super(...arguments),this.empty_lb=null,this.viewState=1,this.friends=[],this.friendsList=[],this.canClick=!0}onOpened(e){this.friends=e.list,this.friendsList=this.friends,this.updateListData(),this.addBox.visible=!1,this.addBox.active=!1,this.itemList.array=this.friendsList,this.isEmpty(),this.itemList.renderHandler=new Laya.Handler(this,this.itemRender),this.itemList.vScrollBarSkin=null,this.userKey.text=`我的友情码：${E.key}`}isEmpty(){this.empty_lb.visible=!this.itemList.array.length}updateListData(){this.friendsList.sort((e,t)=>1e5*t.applyIng-1e5*e.applyIng)}itemRender(e,t){const i=this.friendsList[t];let s=e.getChildByName("new_box"),a=e.getChildByName("heart_box"),n=e.getChildByName("go_play_btn"),o=e.getChildByName("apply_btn"),l=e.getChildByName("del_btn");switch(a.visible=!1,n.visible=!1,o.visible=!1,l.visible=!1,console.log(null==i?void 0:i.avatar),(null==i?void 0:i.avatar)&&(e.getChildByName("head").skin=i.avatar),e.getChildByName("name").text=i.nickname,e.getChildByName("lv").text=(i.orderLevel||0)+"",a.getChildByName("val").text=(i.intimacy||0)+"",e.getChildByName("reward_box").getChildByName("value").text=i.gainDiamond+"",e.getChildByName("del_btn").dataSource=i,n.dataSource=i,this.viewState){case 1:n.visible=!0,a.visible=!0;break;case 2:o.dataSource=i,o.visible=!0,s.visible=!1,s.active=!1;break;case 3:a.visible=!0,l.visible=!0}1!=this.viewState&&3!=this.viewState||(i.applyIng?(s.visible=!0,s.active=!0,s.getChildByName("past_btn").dataSource=i,s.getChildByName("ignore").dataSource=i,a.visible=!1,n.visible=!1):(s.visible=!1,s.active=!1))}onClick(e){if(this.canClick)switch(console.log(e.target.name),e.target.name){case"close":S.view.close(d.views.FriendsView);break;case"add_friend":this.addFriendEvent();break;case"del_friend":this.deleteFriendEvent();break;case"desc_btn":S.view.open(d.views.FriendsDescView);break;case"reward_btn":this.openReward();break;case"copy_btn":this.copy();break;case"search_btn":this.search();break;case"apply_btn":this.applyEvent(e.target);break;case"past_btn":this.allowFriend(e.target);break;case"del_btn":this.deleteFriend(e.target);break;case"ignore":this.ignore(e.target);break;case"go_play_btn":this.visitFriend(e.target)}}deleteFriendEvent(){if(3==this.viewState)return;this.addBox.visible=!1,this.addBox.active=!1,this.viewState=3;let e=[];this.friends.forEach(t=>{t.applyIng||e.push(t)}),this.itemList.array=e,this.itemList.height=914,this.itemList.refresh(),this.isEmpty(),this.addFriend.skin="game/img_friendBtn.png"}addFriendEvent(){3==this.viewState||2==this.viewState?(this.viewState=1,this.itemList.array=this.friends,this.itemList.height=914,this.addFriend.skin="game/img_addBtn.png",this.addBox.visible=!1,this.addBox.active=!1,this.isEmpty()):(this.viewState=2,this.addBox.visible=!0,this.addBox.active=!0,this.itemList.array=[],this.itemList.height=590,this.addFriend.skin="game/img_friendBtn.png",this.empty_lb.visible=!1),this.itemList.refresh()}ignore(e){let t=e.dataSource;this.canClick=!1,$.inst.send({api:A.friendDelete,data:{friendId:t.uid}}).then(e=>{for(let e=0;e<this.friends.length;e++)if(this.friends[e].uid==t.uid){this.friends.splice(e,1);break}this.canClick=!0,this.itemList.refresh(),this.isEmpty()}).catch(()=>{this.canClick=!0})}openReward(){this.canClick=!1,$.inst.send({api:A.friendInviteList,data:{}}).then(e=>{S.view.open(d.views.FriendsRewardView,{parm:{list:e.list,call:()=>{$.inst.send({api:A.friendList}).then(e=>{this.friends=e.list,this.friendsList=this.friends,this.updateListData(),this.itemList.array=this.friendsList,this.isEmpty(),this.itemList.refresh()})}}}),this.canClick=!0}).catch(()=>{this.canClick=!0})}visitFriend(t){this.canClick=!1,S.view.setOverView(!0,()=>{let i=t.dataSource;$.inst.send({api:A.friendVisit,data:{friendId:i.uid}}).then(t=>{S.view.close(d.views.FriendsView),S.eventGlobal.event(e.go_friend_home,[t,i]),setTimeout(()=>{S.view.setOverView(!1),this.canClick=!0},300)}).catch(()=>{this.canClick=!0})})}deleteFriend(e){S.view.openHint({text:"确认要删除好友吗？",call:()=>{let t=e.dataSource;$.inst.send({api:A.friendDelete,data:{friendId:t.uid}}).then(e=>{for(let e=0;e<this.friends.length;e++)if(this.friends[e].uid==t.uid){this.friends.splice(e,1);break}this.itemList.array=this.friendsList,this.itemList.refresh(),this.isEmpty()})},cancelCall:()=>{}})}allowFriend(e){this.canClick=!1;let t=e.dataSource;$.inst.send({api:A.friendAllow,data:{friendId:t.uid}}).then(()=>{t.applyIng=0,this.itemList.refresh(),this.canClick=!0}).catch(()=>{this.canClick=!0})}applyEvent(e){let t=e.dataSource;this.canClick=!1,$.inst.send({api:A.friendApply,data:{friendId:t.uid}}).then(()=>{this.friendsList=[],this.itemList.array=this.friendsList,this.itemList.refresh(),S.view.openHint({text:"已发送激情",call:()=>{}}),this.canClick=!0}).catch(()=>{this.canClick=!0})}search(){this.keyInputNode.text.length?this.keyInputNode.text!=E.key?(this.canClick=!1,$.inst.send({api:A.friendSearch,data:{key:this.keyInputNode.text}}).then(e=>{this.friendsList=[e],this.itemList.array=this.friendsList,this.itemList.refresh(),this.canClick=!0}).catch(()=>{this.canClick=!0})):S.view.openHint({text:"搜索自己干啥",call:()=>{}}):S.view.openHint({text:"友情码不能为空",call:()=>{}})}copy(){let e=document.createElement("input");document.body.appendChild(e),e.value=E.key,e.select(),document.execCommand("copy"),e.remove(),S.view.openHint({text:"复制成功",call:()=>{}})}},Y=class extends S.gameScript{constructor(){super(...arguments),this.guideHand=null,this.descLb=null,this.nodeBox=null,this.textList=["您的钱包余额","这里是市扬订单,按要求完成后会自动进入下一级订单。","这里是产库,收要的作物都存放在这里，出售作物也在这里。","这里是集市,购买种了、狗浪的地方还有品重要的钱庄也在这里,提现的时候您会经常来的。","土地升级在这里,士地等级超高,土地越肥沃，收获就越多","这里是您的农场。种植、收获都在这里,悄销告诉彻这块地收英的时候可能会产出洁石哦。","您的任务","您的来信","这里可以去别人的农场转转,帮别人收收蓝,但是要小心狗狗哦。"],this.step=0,this.canClick=!0}onOpened(e){if(e){if(e.nodeList||(e.nodeList=[]),this.data=e,this.guideHand.alpha=0,this.userStep=E.guideData.split(""),this.userStep.length){for(let e=0;e<9;e++)if(!this.userStep[e]||"0"==this.userStep[e]){this.step=e;break}}else this.step=0;this.guidHandAni(),this.updateStep()}}updateStep(){let e;const t=this.data.nodeList[this.step-1];if(t&&this.oldParent&&(e=this.oldParent.globalToLocal(this.nodeBox.localToGlobal(new Laya.Point(t.x,t.y))),this.oldParent.addChildAt(t,this.oldZOrder),t.pos(e.x,e.y)),!this.textList[this.step])return void S.view.close(d.views.GuideView);const i=this.data.nodeList[this.step];this.oldZOrder=i.zOrder,this.oldParent=i.parent,e=this.nodeBox.globalToLocal(this.oldParent.localToGlobal(new Laya.Point(i.x,i.y))),this.nodeBox.addChild(i),i.pos(e.x,e.y),this.guideHand.scaleX=1;const s=new Laya.Point;switch(this.step){case 0:e.x+=200,e.y+=150,s.setTo(-100,80);break;case 1:e.x+=200,e.y+=250,s.setTo(-300,80);break;case 2:e.x+=200,e.y+=250,s.setTo(-200,80);break;case 3:e.x+=-100,e.y+=250,this.guideHand.scaleX=-1,s.setTo(-400,80);break;case 4:e.x+=200,e.y+=250,s.setTo(-200,80);break;case 5:e.x+=600,e.y+=450,s.setTo(-200,80);break;case 6:case 7:e.x+=160,e.y+=100,s.setTo(-200,-280);break;case 8:e.x+=140,e.y+=100,s.setTo(-560,-380)}Laya.Tween.to(this.guideHand,{x:e.x,y:e.y,alpha:1},300),this.descLb.alpha=0,Laya.Tween.to(this.descLb,{alpha:1},150),this.descLb.pos(e.x+s.x,e.y+s.y),this.descLb.text=this.textList[this.step],this.step++}onClick(e){this.canClick&&(this.canClick=!1,this.userStep[this.step]="1",$.inst.send({api:A.guide,data:{data:this.userStep.join("")}}).then(()=>{this.updateStep(),this.canClick=!0}).catch(()=>{this.canClick=!0}))}guidHandAni(){this.guidAni=Laya.TimeLine.to(this.guideHand,{rotation:-15},400,null).to(this.guideHand,{rotation:0},400),this.guidAni.play(null,!0)}onHdDisable(){var e;null==(e=this.guidAni)||e.destroy()}},q=class extends S.gameScript{onOpened(e){var t;this.data=e,this.text.text=(null==(t=this.data)?void 0:t.text)||"",this.data.call?this.confirmBtn.visible=!0:this.confirmBtn.visible=!1,this.data.cancelCall?this.cancelBtn.visible=!0:this.cancelBtn.visible=!1,this.data.call&&this.data.cancelCall?this.confirmBtn.x=252:this.confirmBtn.x=458}onClick(e){var t,i;switch(e.target.name){case"cancel":(null==(t=this.data)?void 0:t.cancelCall)&&this.data.cancelCall(),S.view.close(d.views.HintView);break;case"confirm":(null==(i=this.data)?void 0:i.call)&&this.data.call(),S.view.close(d.views.HintView)}}},Z=class extends g{constructor(){super(...arguments),this.loadBar=null,this.loadBox=null,this.loginBox=null,this.privacyBox=null,this.privacyCheckIcon=null,this.loadBarOldWidth=0,this.canClick=!0}onOpened(e){return l(this,null,function*(){var t;this.data=e,this.loginBox.visible=!1,this.loadBox.visible=!1,this.privacyBox.visible=!1,yield this.version(),(null==(t=D.getJSON())?void 0:t.isLogin)?(this.login(!1),this.loginBox.visible=!1,this.loadBox.visible=!0):(this.loginBox.visible=!0,this.loadBox.visible=!1,this.privacyBox.visible=!0)})}onHdAwake(){u.on(e.load_progress,this,this.loadProgress),console.log("awake")}onHdEnable(){this.loadBarOldWidth=this.loadBar.width,this.loadBar.width=0}getBuildType(){let e=null;switch("test"){case b.debug:e=3;break;case b.test:e=2;break;case b.online:e=1}return e||S.view.openHint({text:"环境type配置出错",call:()=>{B.runAppFunction({uri:t.clearCache,data:{}}),location.reload()}})}version(){return l(this,null,function*(){return new Promise(e=>{$.inst.send({api:A.configClient,data:{id:this.getBuildType()}}).then(i=>{var s;const a=Number(null==(s=D.getJSON().version)?void 0:s.replace(/\./g,""));if(!a)return e(null),D.setJSON("version",i.version),void(L.version=i.version);Number(i.version.replace(/\./g,""))>a?(B.runAppFunction({uri:t.clearCache,data:{}}),S.view.openHint({text:"检测到新的版本，请更新！",call:()=>{D.setJSON("version",i.version),B.runAppFunction({uri:t.showBackground,data:{}}),location.reload()}})):(L.version=i.version,e(null))}).catch(()=>{alert("版本检测出错"),e(null)})})})}onClick(e){switch(e.target.name){case"login_btn":this.login(!0);break;case"check_box":this.privacyCheckIcon.visible=!this.privacyCheckIcon.visible;break;case"privacy_lb":B.runAppFunction({uri:t.privacyAgreement,data:{}})}}login(e){return l(this,null,function*(){if(this.canClick)if(this.canClick=!1,D.getJSON().token)$.inst.send({api:A.loginToken,error:(e,t)=>{D.clear(),this.loginBox.visible=!0,this.loadBox.visible=!1}}).then(e=>{var i;(null==(i=this.data)?void 0:i.call)&&this.data.call(e),this.loginBox.visible=!1,this.loadBox.visible=!0,this.canClick=!0,B.runAppFunction({uri:t.loginSuccess,data:{user_id:Number(e.userInfo.key)}})}).catch(()=>{this.canClick=!0}),this.privacyBox.visible=!1;else{if(this.privacyBox.visible=!0,!this.privacyCheckIcon.visible)return void S.view.openHint({text:"请阅读《用户隐私协议》",call:()=>{D.clear(),this.loginBox.visible=!0,this.canClick=!0,this.loadBox.visible=!1}});let i=location.search.match(/\?id=(.+)/),s=null;i&&i.length>1&&(s=i[1]);let a=s,n="",o="";if(e&&!a){const e=yield B.runAppFunction({uri:t.wxLogin,data:{},timestamp:Date.now()});e&&(a=e.data.openid,o=e.data.iconurl,n=e.data.name)}if(!a)return void S.view.openHint({text:"未获取到微信id",call:()=>{}});this.privacyBox.visible=!1,$.inst.send({api:A.login,data:{wxId:a,avatar:o,nickname:n},error:(e,t)=>{D.clear(),this.loginBox.visible=!0,this.loadBox.visible=!1,this.canClick=!0}}).then(e=>{var i;(null==(i=this.data)?void 0:i.call)&&this.data.call(e),this.loginBox.visible=!1,this.loadBox.visible=!0,this.canClick=!0,E.isFirstTime||B.runAppFunction({uri:t.registerSuccess,data:{user_id:Number(e.userInfo.key)}}),B.runAppFunction({uri:t.loginSuccess,data:{user_id:Number(e.userInfo.key)}})}).catch(()=>{this.canClick=!0})}})}loadProgress(e){this.loadBar.width=e*this.loadBarOldWidth}onHdDisable(){u.off(e.load_progress,this,this.loadProgress)}},ee=class extends S.gameScript{constructor(){super(...arguments),this.mailId=null}onOpened(e){const t=e.data;this.call=e.call,this.mailId=e.data.id,this.centerPanel.vScrollBarSkin=null,this.title.text=`${t.message}潜入了你的菜地`,console.log(e);const i=[],s=[];let a=0,n=0;N.parseString(t.itemsLost).map(e=>{if(e=N.parseString(e,":"),console.log(e),1==e[0])return void(a+=Number(e[2]));let t=!1;if(i.forEach(i=>{i.id==e[1]&&(t=!0)}),t){for(let t=0;t<i.length;t++)if(i[t].id==e[1]){i[t].amount+=Number(e[2]);break}}else i.push({id:e[1],amount:Number(e[2])})}),N.parseString(t.items).map(e=>{e=N.parseString(e,":");let t=!1;if(s.forEach(i=>{i.id==e[1]&&(t=!0)}),t){for(let t=0;t<s.length;t++)if(s[t].id==e[1]){s[t].amount+=Number(e[2]);break}}else s.push({id:e[1],amount:Number(e[2])})});let o=0,l=0;for(let e=0;e<i.length;e++){let t=this.item.create();l>2&&!o&&(o++,l=-1),o&&l>2&&(o++,l=-1),t.x=230+190*l,t.y=105+95*o,l++;let s=H.table("plant").get(i[e].id);const a=t.getChildByName("icon");a.skin=s.icon,a.scale(.7,.7),a.anchorX=.5,t.getChildByName("lb").text=`x${i[e].amount}`,s.gain.forEach(t=>{t.obj.id!=L.diamondId&&(n+=t.count*i[e].amount)}),this.centerPanel.addChild(t)}let d=0;l=0;for(let e=0;e<s.length;e++){let e=this.item.create();l>1&&!d&&(d++,l=-2),d&&l>1&&(d++,l=-2),e.x=420+190*l,e.y=208+95*o+95*d,l++,this.centerPanel.addChild(e)}this.lostLb.y=114,this.backLb.y=218+95*o,this.bottomLb.y=301+95*o+95*d,this.bottomLb.text=`共计损失了${n}金币，${a}钻石`}onClick(e){switch(e.target.name){case"close":S.view.close(d.views.MailDescView);break;case"delete":$.inst.send({api:A.mailDelete,data:{id:this.mailId}}).then(()=>{this.call&&this.call(this.mailId),Laya.timer.frameOnce(1,this,()=>{S.view.close(d.views.MailDescView)})})}}},te=class extends g{constructor(){super(...arguments),this.list=null,this.empty_lb=null,this.listData=[]}onHdAwake(){this.list.vScrollBarSkin=null,this.list.renderHandler=new Laya.Handler(this,this.renderItem)}onOpened(e=[]){this.listData=e,this.updateListData()}updateListData(){this.list.array=this.listData.sort((e,t)=>t.createTime-(t.read?1e6:0)-(e.createTime-(e.read?1e6:0))),this.empty_lb.visible=!this.list.array.length}renderItem(e,t){const i=this.listData[t];e.getChildByName("title").text="系统邮件",e.getChildByName("desc").text=`${i.message}潜入菜地偷菜,被狗狗发现并追加回了~~`,e.getChildByName("time").text=`${new Date(i.createTime).toLocaleString("zh-CN",{hour12:!1})}`,e.getChildByName("read_icon").visible=!i.read,e.dataSource=i}onClick(e){switch(e.target.name.indexOf("item")>-1&&$.inst.send({api:A.mailRead,data:{id:e.target.dataSource.id}}).then(()=>{e.target.dataSource.read=1,this.list.refresh(),S.view.open(d.views.MailDescView,{parm:{data:e.target.dataSource,call:e=>{for(let t=0;t<this.listData.length;t++)if(this.listData[t].id==e){this.listData.splice(t,1);break}this.list.refresh()}}})}),e.target.name){case"close":f.inst.close(d.views.MailView)}}};!function(e){e[e._2001=2001]="_2001"}(j||(j={}));var ie=j,se=class extends S.gameScript{constructor(){super(...arguments),this.icon=null,this.fieldNode=null,this.shadow=null,this.fieldEmptyRes="",this.lvNode=null,this.timeBox=null,this.countDownLb=null,this.topStateIcon=null,this.upAni=null,this.reduceTime=null,this.unlockIcon="",this.fieldId=null,this.buildIng=!1,this.isOuter=!1,this.canSteal=!1,this.canClick=!0,this.matureTime=0}onHdAwake(){this.fieldNode=this.owner,this.countDownLb=this.timeBox.getChildByName("countDownLb"),this.init()}init(){this.icon.skin=null,this.showShadowIcon(!1),this.timeBox.visible=!1,this.timeBox.active=!1,this.topStateIcon.visible=!1,this.lvNode.visible=!1,this.upAni.visible=!1,this.reduceTime.visible=!1,this.upAni.on(Laya.Event.COMPLETE,this,()=>{this.upAni.visible=!1}),this.matureTime=Date.now()}updateData(e){(null==e?void 0:e.list)?this.landList=e.list:this.landList=U.list,this.data=this.landList.get(this.fieldId),this.renderData()}renderData(){var e;this.topStateIconAni(!1),this.data?(this.icon.y=164,this.showShadowIcon(!1),this.topStateIcon.visible=!1,this.fieldNode.skin=this.fieldEmptyRes,this.showIcon(Boolean(this.data.productId)),this.lvNode.visible=!0,this.updateLevel(),this.timeBox.visible=!1,this.data.productId&&this.plantIconAni(!0),this.data.productId&&this.data.matureTimeLeft>0?(this.matureTime=1e3*this.data.matureTimeLeft+Date.now(),this.timeBox.visible=!0,this.timeBox.active=!0,this.icon.skin=H.table("plant").get(this.data.productId).growingIcon,this.showShadowIcon(!0),this.updateCountDown(),this.isOuter?this.topStateIcon.visible=!1:this.plantIconAni(!0)):this.data.productId&&(this.matureTime=Date.now(),this.topStateIcon.visible=!0,this.showShadowIcon(!0),this.updateCountDown(),this.setStateIconSkin(3))):(this.lvNode.visible=!1,this.fieldNode.skin="main_scene/img_wasteland.png",this.icon.skin=this.unlockIcon,this.icon.y=113,this.showIcon(!1),this.topStateIconAni(!1),this.topStateIcon.visible=!1,this.showTimeBox(!1),this.showShadowIcon(!1),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),null==(e=this.topStateIconTween)||e.destroy(),this.topStateIconTween=null)}showIcon(e){this.icon.visible=e}setStateIconSkin(e){switch(e){case 1:this.topStateIcon.skin="main_scene/img_speedUp.png";break;case 2:this.topStateIcon.skin="main_scene/img_landUpdateBtn2.png";break;case 3:this.topStateIcon.skin="main_scene/img_harvest.png"}}topStateIconAni(e){var t;this.topStateIcon.y=-107,this.topStateIconTween||(this.topStateIconTween=Laya.TimeLine.to(this.topStateIcon,{y:this.topStateIcon.y-50},800,null).to(this.topStateIcon,{y:this.topStateIcon.y},800),this.topStateIconTween.play(null,!0)),this.stealUid&&!(null==(t=this.data)?void 0:t.canSteal)&&(e=!1),this.topStateIcon.visible=e,e?this.topStateIconTween.resume():this.topStateIconTween.pause()}showTimeBox(e){this.timeBox.visible=e}showShadowIcon(e){this.shadow.visible=e,this.shadow.active=e}plantIconAni(e){this.plantIconTween||(this.plantIconTween=Laya.TimeLine.to(this.icon,{skewX:3},1e3).to(this.icon,{skewX:-3},2e3).to(this.icon,{skewX:0},1e3),this.plantIconTween.play(null,!0)),e?Laya.timer.once(1e3*Math.random(),this,()=>{this.plantIconTween.resume()}):this.plantIconTween.pause()}updateCountDown(){var e,t;this.data.matureTimeLeft>0?(this.countDownLb.text=N.formatSeconds(this.data.matureTimeLeft),Laya.timer.clearAll(this),Laya.timer.once(1e3,this,()=>(this.data.matureTimeLeft=Math.ceil((this.matureTime-Date.now())/1e3),this.data.matureTimeLeft<0&&(this.data.matureTimeLeft=0),this.countDownLb.text=N.formatSeconds(this.data.matureTimeLeft),this.updateCountDown()))):(this.data.matureTimeLeft=0,this.matureTime=Date.now(),console.log("成熟 "),this.icon.skin=null==(t=H.table("plant").get(null==(e=this.data)?void 0:e.productId))?void 0:t.matureIcon,this.buildIng||(this.setStateIconSkin(3),this.mainViewCom.updateAllStateIcon()),this.showTimeBox(!1))}updateLevel(){this.lvNode.skin=`main_scene/img_level${this.data.level}.png`}speedUp(){var e;(null==(e=this.data)?void 0:e.matureTimeLeft)&&(this.data.matureTimeLeft-=H.table("config").get("all_speed_up_time").value,this.matureTime=1e3*this.data.matureTimeLeft+Date.now(),this.updateCountDown(),console.log(11),this.reduceTime.visible=!0,this.reduceTime.alpha=0,this.reduceTime.y=-39,this.reduceTimeAni||(this.reduceTimeAni=Laya.TimeLine.to(this.reduceTime,{y:-69,alpha:1},300).to(this.reduceTime,{y:-100,alpha:0},300,null,1e3)),this.reduceTimeAni.play())}clearField(){this.topStateIcon.visible=!1,this.data.productId=null,this.icon.skin=null,this.showIcon(!1),this.showShadowIcon(!1)}onClick(){return l(this,null,function*(){if(S.audio.playSound(d.audios.button_click),this.canClick)if(this.isOuter)this.data&&this.stealFood(this.data);else if(this.data){if(this.buildIng)return void(H.table("landLevel").get(this.data.level+1)?S.view.open(d.views.FieldLevelUpView,{parm:{obj:this.data,call:()=>{this.data.level++,this.updateLevel(),S.audio.playSound(d.audios.tudishengji),this.upAni.visible=!0,this.upAni.play(0,!1)}}}):(console.log("满级"),this.topStateIconAni(!1),S.view.openHint({text:"已满级",call:()=>{}})));if(this.data.productId){if(this.data.matureTimeLeft)return console.log("加速"),S.view.open(d.views.SpeedUpView,{parm:{call:()=>{this.mainViewCom.updateAllStateIcon()}}}),void this.mainViewCom.updateAllStateIcon(this.data.id);{console.log("收获"),this.canClick=!1;let t=0,i=0,s=this.data.productId;$.inst.send({api:A.landGather,data:{landId:this.data.id,type:L.ApiTypeDefault}}).then(a=>{t=a.amount,R.add(s,a.amount),S.audio.playSound(d.audios.shoucai),i=a.rewardDiamond,this.clearField(),this.canClick=!0;let n=[{obj:H.table("plant").get(s),count:t,posType:3}];i&&n.push({obj:H.table("currency").get(L.diamondId),count:i,posType:2}),S.eventGlobal.event(e.play_get_reward,{node:this.owner,list:n,callBack:()=>{}}),Laya.timer.frameOnce(1,this,()=>{this.mainViewCom.updateAllStateIcon()})}).catch(()=>{this.canClick=!0})}}else S.view.open(d.views.ShopView,{parm:{id:0,parm:{landId:this.fieldId},call:e=>{this.landList.get(this.fieldId).productId=e.base.id,this.landList.get(this.fieldId).matureTimeLeft=e.base.mature_time,this.matureTime=1e3*e.base.mature_time+Date.now(),this.data=this.landList.get(this.fieldId),this.renderData(),S.audio.playSound(d.audios.zhongzhi),this.mainViewCom.updateAllStateIcon(this.data.id)}}})}else S.view.open(d.views.AddLandView,{parm:{id:this.fieldId,call:()=>{this.data={id:this.fieldId,level:1,matureTimeLeft:0,productId:null},this.matureTime=Date.now(),U.addLand(this.data),this.updateData(),this.mainViewCom.updateHitLandAdd()}}})})}stealFood(t){return l(this,null,function*(){var i;if(t.productId&&!t.matureTimeLeft){if(!this.canSteal||this.stealUid&&!(null==(i=this.data)?void 0:i.canSteal))return console.log("已经不可偷"),void S.view.openHint({text:"给我留点吧",call:()=>{}});S.audio.playSound(d.audios.goujiaosheng),this.canClick=!1,$.inst.send({api:A.landSteal,data:{landId:this.data.id,type:L.ApiTypeDefault,uid:this.stealUid}}).then(t=>{this.canClick=!0,E.vitality=t.vitality,this.canSteal=!1,this.topStateIconAni(!1),R.add(this.data.productId,t.amount),S.audio.playSound(d.audios.shoucai);const i=[];t.plantId?i.push({obj:H.table("plant").get(t.plantId),count:t.amount,posType:3}):S.view.openHint({text:"额，被狗咬了~~~没偷着~",call:()=>{}}),t.rewardDiamond&&i.push({obj:H.table("currency").get(L.diamondId),count:t.rewardDiamond,posType:2}),i.length&&S.eventGlobal.event(e.play_get_reward,{node:this.owner,list:i})}).catch(e=>{this.canClick=!0,e===ie._2001&&this.clearField()})}})}onHdDestroy(){var e,t;Laya.timer.clearAll(this),Laya.Tween.clearAll(this),null==(e=this.topStateIconTween)||e.destroy(),null==(t=this.plantIconTween)||t.destroy(),this.topStateIconTween=null,this.plantIconTween=null}};o([S.findByName],se.prototype,"icon",2),o([S.findByName],se.prototype,"fieldNode",2),o([S.findByName],se.prototype,"shadow",2),o([S.findByName],se.prototype,"lvNode",2),o([S.findByName],se.prototype,"timeBox",2),o([S.findByName],se.prototype,"topStateIcon",2),o([S.findByName],se.prototype,"upAni",2),o([S.findByName],se.prototype,"reduceTime",2),o([S.eventOn(e.update_field)],se.prototype,"updateData",1),o([S.eventOn(e.land_speed_up)],se.prototype,"speedUp",1);var ae=class extends S.gameScript{constructor(){super(...arguments),this.addLandLayer=null,this.diamondNode=null,this.goldNode=null,this.avatarNode=null,this.landBox=null,this.centerBox=null,this.orderBox=null,this.bottomBox=null,this.landUpLayer=null,this.topLayerOnStage=null,this.topGoldIcon=null,this.topDiamondIcon=null,this.warehouseBtn=null,this.moneyLb=null,this.getRewardPrefab=null,this.floatRewardIcon=null,this.goHomeBtn=null,this.anyDoor=null,this.vitalityBox=null,this.vitalityBuyBtn=null,this.petBox=null,this.taskBox=null,this.step1=null,this.step2=null,this.step3=null,this.step4=null,this.step5=null,this.step6=null,this.step7=null,this.step8=null,this.step9=null,this.landList=[],this.isOuter=!1,this.outCountDownNumber=60,this.canClick=!0,this.orderQueueIng=!1}onOpened(){["res/loadingBg.png","res/img_woodtitle.png","res/img_storeHouseBg.png","res/img_storebg.png","res/img_shelf.png","res/img_popUpBg.png","res/img_landBg.png","res/img_inviteBg1.png","res/img_housetop.png","res/img_farmlandLogo.png","res/atlas/plant_icon.png","res/atlas/pet_feed.png","res/atlas/main_scene.png"].forEach(e=>{e.endsWith("png")&&Laya.loader.clearTextureRes(e)}),Laya.timer.frameOnce(1,this,()=>{this.updateTask()});let e=!1,t=0;E.guideData.length&&(E.guideData.split("").forEach(e=>{"1"==e&&t++}),t>=9&&(e=!0)),E.guideData.length&&e||S.view.open(d.views.GuideView,{parm:{nodeList:[this.step1,this.step2,this.step3,this.step4,this.step5,this.step6,this.step7,this.step8,this.step9],call:()=>{}}})}onHdAwake(){Laya.stage.addChild(this.topLayerOnStage),this.orderBox.getChildByName("friend_name").visible=!1,this.landUpLayer.visible=!1,this.landUpLayer.active=!1,this.vitalityBox.visible=!1,this.goHomeBtn.visible=!1;for(let e=0;e<this.landBox.numChildren;e++)this.landList.push(this.landBox.getChildAt(e).getComponent(se)),this.landList[e].mainViewCom=this;this.landList.sort((e,t)=>e.fieldId-t.fieldId),Laya.timer.frameOnce(1,this,()=>{S.eventGlobal.event(e.update_field),this.updateHitLandAdd(),this.updateAllStateIcon()}),this.figureAniEvent()}figureAniEvent(){}updateHitLandAdd(){let e;for(let t=0,i=this.landList.length;t<i;t++){if(!this.landList[t].data){this.landList[t].showIcon(!0);break}e||(e=this.landList[t])}}updateAllStateIcon(e){for(let e=0,t=this.landList.length;e<t;e++)this.landList[e].topStateIconAni(!1);for(let t=0,i=this.landList.length;t<i;t++){const i=this.landList[t].data;if(i){if(i.id==e){this.landList[t].showIcon(!0),this.landList[t].setStateIconSkin(1),this.landList[t].topStateIconAni(!0);break}if(!e&&i.productId&&i.matureTimeLeft){this.landList[t].showIcon(!0),this.landList[t].setStateIconSkin(1),this.landList[t].topStateIconAni(!0);break}}}for(let e=0,t=this.landList.length;e<t;e++){const t=this.landList[e].data;t&&t.productId&&!t.matureTimeLeft&&(this.landList[e].showIcon(!0),this.landList[e].setStateIconSkin(3),this.landList[e].topStateIconAni(!0))}}onHdEnable(){S.observableProperty.watch(E,this).key("diamond",e=>{this.diamondNode.value=e,this.moneyLb.value=(e*E.proportion).toString().match(/^\d+(?:\.\d{0,2})?/)+""}).key("gold",e=>{this.goldNode.value=e}).key("avatar",e=>{e&&(this.avatarNode.skin=e)}).key("warePetId",e=>{e?(this.petBox.visible=!0,this.petBox.getChildByName("dog").skin=H.table("pet").get(e).icon):this.petBox.visible=!1}).key("petVitality",e=>{if(E.warePetId&&this.petBox.visible){let t=this.petBox.getChildByName("box").getChildByName("vitality_bar"),i=e/H.table("pet").get(E.warePetId).vitality_max;i>1&&(i=1),t.width=130*i}}).key("digestCountDown",e=>{Laya.timer.clear(this,this.digestCountDown),this.petBox.visible&&Laya.timer.once(1e3*e,this,this.digestCountDown)}).key("vitality",e=>{let t=e/L.userVitalityLimit;t>=1?(t=1,this.vitalityBuyBtn.gray=!0,Laya.timer.frameOnce(1,this,()=>{this.vitalityBuyBtn.mouseEnabled=!1})):(this.vitalityBuyBtn.gray=!1,Laya.timer.frameOnce(1,this,()=>{this.vitalityBuyBtn.mouseEnabled=!0})),this.vitalityBox.getChildByName("bar")&&(this.vitalityBox.getChildByName("bar").width=268*t)}),this.addLandLayer.visible=!1,this.updateOrder()}digestCountDown(){if(!E.warePetId)return;const e=H.table("pet").get(E.warePetId);E.petVitality-e.vitality_consume<=0?E.petVitality=0:E.petVitality-=e.vitality_consume,E.digestCountDown=L.petDigestIntervalTime}onClick(e){switch(console.log(e.target.name),e.target.name){case"closeAddLandLayer":this.addLandLayer.visible=!1;break;case"task":S.view.open(d.views.TaskView);break;case"signIn":S.view.open(d.views.SignInView);break;case"mail":this.openMail();break;case"shop":S.view.open(d.views.ShopView);break;case"head":S.view.open(d.views.SettingView);break;case"warehouse":S.view.open(d.views.WarehouseView);break;case"buy_feed":S.view.open(d.views.ShopView,{parm:{id:2}});break;case"dog_house":S.view.open(d.views.ShopView,{parm:{id:1}});break;case"dog":S.view.open(d.views.ShopView,{parm:{id:2}});break;case"diamond_box":case"money_red_box":S.view.open(d.views.ShopView,{parm:{id:3}});break;case"order_box":S.view.open(d.views.OrderView);break;case"friends":this.openFriend();break;case"land":break;case"landLevelUp":this.isOuter||this.switchLandLevelUp(!0);break;case"close_up":this.switchLandLevelUp(!1);break;case"any_door":this.goToNeighbor();break;case"go_home":this.goHome();break;case"add_vitality":this.buyVitality()}}openMail(){this.canClick&&(this.canClick=!1,$.inst.send({api:A.mailList}).then(e=>{S.view.open(d.views.MailView,{parm:e}),this.canClick=!0}).catch(()=>{this.canClick=!0}))}openFriend(){this.canClick&&(this.canClick=!1,$.inst.send({api:A.friendList}).then(e=>{this.canClick=!0,S.view.open(d.views.FriendsView,{parm:e})}).catch(()=>{this.canClick=!0}))}buyVitality(){S.view.open(d.views.BuyVitalityView)}updateOrder(){var e;if(!this.orderQueueIng){let t,i=this.orderBox.getChildByName("order_box"),s=H.table("order").get(E.orderLevel+1),a=0,n=0,o=0,l=0;if(!s)return console.log("等级已完");for(let d=0;d<4;d++){let c=i.getChildByName("item_"+d);s.condition[d]?((n=(null==(e=R.getOne(s.condition[d].plant.id))?void 0:e.count)||0)>=(o=s.condition[d].count)&&l++,c.getChildByName("icon").skin=s.condition[d].plant.icon,c.getChildByName("num").text=`${n}/${o}`,c.getChildByName("bar").width=87*(n/o>1?1:n/o),c.visible=!0,s.condition[d].plant.gain.forEach(e=>{e.obj.id===L.goldId&&(t||(t=e),a+=e.count*o)})):c.visible=!1}if(t){let e=i.getChildByName("btn_box").getChildByName("box");e.getChildByName("icon").skin=t.obj.icon,e.getChildByName("value").value=`${a+Math.round(a*s.commission)}`}if(i.getChildByName("name_title").text=`完成${E.orderLevel+1}级订单`,l==s.condition.length){const e=s.condition;this.orderQueueIng=!0,$.inst.send({api:A.orderReward,data:{orderId:E.orderLevel+1}}).then(()=>{e.forEach(e=>{R.reduceAmount(e.plant.id,e.count)}),this.orderQueueIng=!1,E.orderLevel++,this.playGetRewardAni({node:i.getChildByName("btn_box"),list:[{obj:H.table("currency").get(L.goldId),count:a+Math.round(a*s.commission),posType:1}],callBack:()=>{this.updateOrder()}})}).catch(()=>{this.orderQueueIng=!1})}}}switchLandLevelUp(e){let t=this.landUpLayer.getChildByName("bg");e?(t.alpha=0,Laya.Tween.to(t,{alpha:.75},150),this.landUpLayer.getChildByName("land_outer").addChild(this.landBox),this.landUpLayer.active=!0,this.landUpLayer.visible=!0,this.landList.forEach(e=>{e.data&&H.table("landLevel").get(e.data.level+1)&&(e.showIcon(!1),e.setStateIconSkin(2),e.topStateIconAni(!0),e.showTimeBox(!1),e.showShadowIcon(!1)),e.buildIng=!0})):(Laya.Tween.to(t,{alpha:0},150,null,Laya.Handler.create(this,()=>{this.landUpLayer.active=!1,this.landUpLayer.visible=!1,this.centerBox.addChild(this.landBox)})),this.landList.forEach(e=>{e.data&&(e.showIcon(!0),e.data.id?(e.data.matureTimeLeft&&(e.showTimeBox(!0),e.showShadowIcon(!0)),e.data.productId||e.clearField()):e.clearField()),e.buildIng=!1,e.data?(e.data.id&&e.setStateIconSkin(e.data.matureTimeLeft?1:3),e.topStateIconAni(Boolean(e.data.productId))):(e.setStateIconSkin(1),e.topStateIconAni(!1))}))}playGetRewardAni(e){Laya.timer.once(2e3,this,()=>{e.callBack&&e.callBack()}),e.list.forEach((t,i)=>{var s;let a=Laya.Pool.getItemByCreateFun("floatRewardBox",this.getRewardPrefab.create,this.getRewardPrefab),n=a.getChildByName("icon");n.skin=(null==(s=t.obj)?void 0:s.icon)||"";let o=80/n.width;n.scale(o,o),a.alpha=0;let l=this.topLayerOnStage.globalToLocal(e.node.localToGlobal(new Laya.Point));a.pos(l.x+e.node.get_width()*e.node.anchorX,l.y-60*i),this.topLayerOnStage.addChild(a),a.getChildByName("count").value="x"+t.count,Laya.Tween.to(a,{y:a.y-40,alpha:1},150,null,Laya.Handler.create(this,i=>{Laya.timer.once(1e3,this,()=>{Laya.Pool.recover("floatRewardBox",i);let s=this.topLayerOnStage.globalToLocal(i.localToGlobal(Laya.Point.create()));if(i.removeSelf(),!e.notFly)for(let e=0;e<5;e++){let i,a=Laya.Pool.getItemByCreateFun("floatRewardIcon",this.floatRewardIcon.create,this.floatRewardIcon);switch(a.skin=t.obj.icon,a.pos(s.x+20*Math.random()*(Math.random()<.5?1:-1),s.y+20*Math.random()*(Math.random()<.5?1:-1)),a.scale(o,o),this.topLayerOnStage.addChild(a),a.zOrder=999,t.posType){case 1:i=this.topGoldIcon;break;case 2:i=this.topDiamondIcon;break;case 3:i=this.warehouseBtn}let n=i.localToGlobal(new Laya.Point(i.width/2,i.height/2)),l=this.topLayerOnStage.globalToLocal(n);Laya.Tween.to(a,{x:l.x,y:l.y},1e3,Laya.Ease.backIn,Laya.Handler.create(this,e=>{e.removeSelf(),Laya.Pool.recover("floatRewardIcon",e)},[a]),150*e)}})},[a]),50*i,null,!0)})}playAdReward(t){const i=H.table("config").get("Videorewards").value;S.eventGlobal.event(e.play_get_reward,{node:t,list:[{obj:i.obj,count:i.count,posType:i.obj.id==L.goldId?1:2}]})}updateTask(){const e=this.taskBox,t=e.getChildByName("icon"),i=t.getChildByName("amountFont"),s=e.getChildByName("lb"),a=P.getList()[0];1==a.receive||this.isOuter?e.visible=!1:(e.visible=!0,s.text=`任务:${a.base.desc}(${a.times>a.base.times?a.base.times:a.times}/${a.base.times})`,i.value="x"+a.base.reward.count,t.skin=a.base.reward.obj.icon,e.width=s.width+100)}goHome(){S.view.setOverView(!0,()=>{$.inst.send({api:A.goHome,data:{}}).then(()=>{this.isOuter=!1,Laya.timer.once(300,this,()=>{S.view.setOverView(!1),this.goFriend(null),this.updateHitLandAdd()})})})}goToNeighbor(){S.view.setOverView(!0,()=>{$.inst.send({api:A.neighbor,data:{type:L.ApiTypeDefault}}).then(e=>{this.isOuter=!0,this.goFriend(e),Laya.timer.once(300,this,()=>{S.view.setOverView(!1)})})})}goFriendListen(e,t){this.isOuter=!0,this.goFriend(e,t)}goFriend(e,t){var i;let s=this.landList,a=U.list,n=new Map;this.isOuter?(e.lands.forEach(e=>{n.set(e.id,e)}),this.outerTime=Date.now(),this.vitalityBox.visible=!0,this.goHomeBtn.visible=!0,this.anyDoor.visible=!1):(a.forEach(e=>{e.matureTimeLeft-=(Date.now()-this.outerTime)/1e3,e.matureTimeLeft<0&&(e.matureTimeLeft=0)}),this.vitalityBox.visible=!1,this.anyDoor.visible=!0,this.goHomeBtn.visible=!1);for(let t=0;t<s.length;t++){const o=s[t];this.isOuter?(o.isOuter=!0,o.stealUid=e.uid,o.updateData({list:n}),e.protectedTime?(o.canSteal=!1,o.topStateIconAni(!1)):o.canSteal=!0):(o.canSteal=!1,o.isOuter=!1,o.stealUid=null,o.updateData({list:a})),o.plantIconAni(Boolean(null==(i=o.data)?void 0:i.productId))}this.updateAllStateIcon(),this.isOuter?(this.petBox.visible=!1,this.taskBox.visible=!1):(E.warePetId&&(this.petBox.visible=!0),this.taskBox.visible=!0),this.updateFriendView(null==e?void 0:e.nickname,t)}updateFriendView(e="",t){const i=this.orderBox.parent,s=i.getChildByName("money_box"),a=i.getChildByName("count_down"),n=this.orderBox.getChildByName("order_box"),o=this.orderBox.getChildByName("friend_name"),l=[this.bottomBox.getChildByName("task"),this.bottomBox.getChildByName("signIn"),this.bottomBox.getChildByName("friends"),this.bottomBox.getChildByName("mail")];this.isOuter?(o.text=`${e}的农场`,n.visible=!1,o.visible=!0,s.visible=!1,a.visible=!0,a.text=N.formatSeconds(this.outCountDownNumber),Laya.timer.loop(1e3,this,this.outCountDownEvent,[a]),(null==t?void 0:t.avatar)&&(this.avatarNode.skin=null==t?void 0:t.avatar)):(this.outCountDownNumber=60,Laya.timer.clear(this,this.outCountDownEvent),n.visible=!0,o.visible=!1,s.visible=!0,a.visible=!1,E.avatar||(this.avatarNode.skin=E.avatar)),l.forEach(e=>{e.disabled=this.isOuter})}outCountDownEvent(e){this.outCountDownNumber--,e.text=N.formatSeconds(this.outCountDownNumber),this.outCountDownNumber<=0&&(Laya.timer.clear(this,this.outCountDownEvent),this.goHome())}};o([S.eventOn(e.update_Order)],ae.prototype,"updateOrder",1),o([S.eventOn(e.play_get_reward)],ae.prototype,"playGetRewardAni",1),o([S.eventOn(e.play_ad_get_reward)],ae.prototype,"playAdReward",1),o([S.eventOn(e.update_task)],ae.prototype,"updateTask",1),o([S.eventOn(e.go_friend_home)],ae.prototype,"goFriendListen",1);var ne=class extends Laya.Script{constructor(){super(),this._x="0",this._y="0",this.delay="0",this.time="10000"}onEnable(){let e=this.owner;e.alpha=0;let t={x:e.x,y:e.y},i=Number(this.delay);Laya.Tween.to(e,{alpha:1},600,null,null,i),Laya.Tween.to(e,{x:this._x,y:this._y},Number(this.time),null,Laya.Handler.create(this,()=>{e.pos(t.x,t.y),this.onEnable()}),i)}onDisable(){}},oe=class extends S.gameScript{constructor(){super(...arguments),this.orderList=null,this.btnLockRes=null,this.btnResCur=null}onOpened(){this.dataList=H.table("order").list;let e=E.orderLevel||0;this.dataList.sort((t,i)=>t.id*(i.id<=e?-1:1)),this.orderList.array=this.dataList,this.orderList.renderHandler=new Laya.Handler(this,this.renderList),this.orderList.vScrollBarSkin=null}renderList(e,t){var i;let s,a=this.dataList[t],n=0,o=0,l=0,d=e.getChildByName("reward_box");e.getChildByName("order_lv").text=`${a.id}级订单`;for(let t=0;t<4;t++){let d=e.getChildByName("item_"+t);a.condition[t]?((o=(null==(i=R.getOne(a.condition[t].plant.id))?void 0:i.count)||0)>=(l=a.condition[t].count)&&0,d.getChildByName("icon").skin=a.condition[t].plant.icon,a.id<E.orderLevel+1?(d.getChildByName("num").text=`${l}/${l}`,d.getChildByName("bar").width=87):(d.getChildByName("num").text=`${o}/${l}`,d.getChildByName("bar").width=87*(o/l>1?1:o/l)),d.visible=!0,a.condition[t].plant.gain.forEach(e=>{e.obj.id===L.goldId&&(s||(s=e),n+=e.count*a.condition[t].count)})):d.visible=!1}let c=e.getChildByName("btn");a.id>E.orderLevel+1?(c.skin=this.btnLockRes,c.active=!1):a.id==E.orderLevel+1?c.skin=this.btnResCur:(console.log("已完成"),c.gray=!0,c.active=!1),s&&(d.getChildByName("icon").skin=s.obj.icon,d.getChildByName("value").text=`+${n+Math.round(n*a.commission)}`)}onClick(e){switch(e.target.name){case"close":S.view.close(d.views.OrderView)}}},le=class extends S.gameScript{onHdEnable(){}onOpened(e){(null==e?void 0:e.call)&&e.call(this)}close(e){this.leftBox.x=-987,this.rightBox.x=1025,this.leftBox.alpha=0,this.rightBox.alpha=0,Laya.Tween.to(this.leftBox,{x:0,alpha:1},500),Laya.Tween.to(this.rightBox,{x:0,alpha:1},500,null,Laya.Handler.create(this,()=>{e&&e()}))}open(e){Laya.Tween.to(this.leftBox,{x:-987,alpha:0},500),Laya.Tween.to(this.rightBox,{x:1025,alpha:0},500,null,Laya.Handler.create(this,()=>{e&&e(),S.view.close(d.views.OverView)}))}},de=class extends S.gameScript{constructor(){super(...arguments),this.musicNode=null,this.soundNode=null,this.avatarNode=null,this.nickname=null}onOpened(){this.musicChange(),this.soundChange(),this.userKey.text=`邀请码：${E.key}`,S.observableProperty.watch(E,this).key("avatar",e=>{e&&(this.avatarNode.skin=e)}).key("nickname",e=>{this.nickname.text=e})}onClick(i){switch(console.log(i.target.name),i.target.name){case"close":S.view.close(d.views.SettingView);break;case"music":S.audio.playSound(d.audios.button_click),S.audio.musicMuted=!S.audio.musicMuted,D.setJSON("music",S.audio.musicMuted),this.musicChange();break;case"sound":S.audio.playSound(d.audios.button_click),S.audio.soundMuted=!S.audio.soundMuted,D.setJSON("sound",S.audio.soundMuted),this.soundChange();break;case"sign_out":S.view.openHint({text:"确认要退出登录？",call:()=>{D.setJSON("isLogin",!1),D.setJSON("token",null),G.loginOut(),Laya.timer.frameOnce(1,this,()=>{S.view.loginOut(),S.view.open(d.views.LoginView,{parm:{call:()=>{S.eventGlobal.event(e.login_game)}}})})},cancelCall:()=>{}});break;case"user_agreement":B.runAppFunction({uri:t.serviceAgreement,data:{}});break;case"privacy":B.runAppFunction({uri:t.privacyAgreement,data:{}});break;case"about":S.view.open(d.views.AboutView);break;case"copy_btn":this.copy()}}copy(){let e=document.createElement("input");document.body.appendChild(e),e.value=E.key,e.select(),document.execCommand("copy"),e.remove(),S.view.openHint({text:"复制成功",call:()=>{}})}musicChange(){const e=this.musicNode.getChildByName("box"),t=e.getChildByName("icon");let i=S.audio.musicMuted;console.log(i),t.x=i?91:-14,t.skin=i?"game/img_musicOffBtn.png":"game/img_musicOnBtn.png",e.skin=i?"game/img_swithOff.png":"game/img_switchOn.png"}soundChange(){const e=this.soundNode.getChildByName("box"),t=e.getChildByName("icon");let i=S.audio.soundMuted;t.x=i?91:-14,t.skin=i?"game/img_musicOffBtn.png":"game/img_musicOnBtn.png",e.skin=i?"game/img_swithOff.png":"game/img_switchOn.png"}},ce=new class{constructor(){this.list=[]}init(){H.table("feed").list.forEach(e=>{this.list.push({base:e,lock:!1})})}clear(){this.list.length=0}},re=class extends g{constructor(){super(...arguments),this.itemList=null,this.btnBoxTop=null,this.bottomBox=null,this.seedDesc=null,this.matureTime=null,this.matureGainBox=null,this.lockBtnBox=null,this.itemBuyBtn=null,this.feedBuyBtn=null,this.feedDesc=null,this.petIcon=null,this.petDesc=null,this.petName=null,this.vitalityMax=null,this.petBuyBtn=null,this.goWatch=null,this.goRest=null,this.diamondFont=null,this.priceList=null,this.proportion=null,this.priceDataList=[],this.priceSelectIndex=null,this.btnTopResList=[["game/img_seedsNormal.png","game/img_seedsSelected.png"],["game/img_petNormal.png","game/img_petSelected.png"],["game/img_foodnNormal.png","game/img_foodnSelected.png"],["game/img_bankNormal.png","game/img_bankSelected.png"]],this.topBtnSelectIndex=0,this.itemListSelectIndex=0,this.itemSelectBg=["game/img_petbagNormal.png","game/img_petbagSelected.png"],this.selectPetIndex=0,this.isFirst=!0,this.canClick=!0}onHdAwake(){this.itemList.renderHandler=new Laya.Handler(this,this.updateItem),this.itemList.selectHandler=new Laya.Handler(this,this.onSelect),this.itemList.vScrollBarSkin=null,this.priceList.renderHandler=new Laya.Handler(this,this.updatePriceItem),this.priceList.selectHandler=new Laya.Handler(this,this.onPriceSelect),S.observableProperty.watch(E,this).key("diamond",e=>{this.diamondFont.value=e;let t=H.table("config").get("withdrawal").value;this.proportion.text=` = ¥${(Number(t[2])/Number(t[1])*e).toString().match(/^\d+(?:\.\d{0,2})?/)}元`})}onOpened(e){this.data=e,this.topBtnSelectIndex=(null==e?void 0:e.id)||0,this.priceDataList=H.table("config").get("withdrawal_times").value,this.updateTopBtnState()}onSelect(e){this.itemListSelectIndex=e}getDataList(){return 0==this.topBtnSelectIndex?F.list:2==this.topBtnSelectIndex?(ce.list.length||ce.init(),ce.list.sort((e,t)=>e.base.vitality-t.base.vitality)):void 0}updateItem(e,t){let i=this.getDataList()[t],s=e.getChildByName("hbox"),a=e.getChildByName("lock_icon");if(!i)return console.warn("数据丢失");if(i.lock)a.visible=!0,a.active=!0,s.visible=!1,s.active=!1;else{a.visible=!1,a.active=!1,s.visible=!0,s.active=!0;let e=0,t="";0==this.topBtnSelectIndex?(e=i.base.seed_price.count,t=i.base.seed_price.obj.icon):(e=i.base.cost.count,t=i.base.cost.obj.icon),s.getChildByName("num").value=e+"",s.getChildByName("gold_icon").skin=t}e.getChildByName("icon").skin=i.base.icon,e.getChildByName("name").text=i.base.name,t==this.itemListSelectIndex?(e.skin=this.itemSelectBg[1],this.updateSelectDesc(),this.isFirst||S.audio.playSound(d.audios.button_click),this.isFirst=!1):e.skin=this.itemSelectBg[0]}updateSelectDesc(){var e,t,i,s;let a=this.getDataList()[this.itemListSelectIndex];if(2===this.topBtnSelectIndex){this.seedDesc.parent.visible=!1,this.feedDesc.text=a.base.desc.replace("&",a.base.vitality+""),this.feedDesc.visible=!0;let e=this.feedBuyBtn.getChildByName("box");return e.getChildByName("icon").skin=a.base.cost.obj.icon,void(e.getChildByName("value").value=a.base.cost.count+"")}let n=a.base;this.seedDesc.parent.visible=!0,this.feedDesc.visible=!1,this.seedDesc.text=n.desc,this.matureTime.text=N.formatSeconds(n.mature_time),(null==(e=this.data)?void 0:e.call)?this.itemBuyBtn.visible=!a.lock:this.itemBuyBtn.visible=!1,this.lockBtnBox.visible=a.lock,this.lockBtnBox.active=a.lock;let o=n.gain;for(let e=0;e<3;e++){let t=this.matureGainBox.getChildAt(e),i=null,s=0,a=o[e-1];0===e?(s=n.harvest,i=n.icon):a&&(i=a.obj.icon,s=a.count*n.harvest),t.getChildByName("icon").skin=i,t.getChildByName("count").text="x"+s}let l=this.lockBtnBox.getChildByName("unlock_buy").getChildByName("box");l.getChildByName("icon").skin=null==(i=null==(t=n.unlock_cost)?void 0:t.obj)?void 0:i.icon,l.getChildByName("value").value=(null==(s=n.unlock_cost)?void 0:s.count)+""}onClick(t){var i;switch(t.target.name){case"close":f.inst.close(d.views.ShopView);break;case"seed":case"pet":case"feed":case"bank":S.audio.playSound(d.audios.button_click);let s=this.btnBoxTop.getChildIndex(t.target);this.topBtnSelectIndex!=s&&(this.topBtnSelectIndex=Number(s),this.updateTopBtnState());break;case"buy_btn":if(!this.canClick)return;this.canClick=!1,$.inst.send({api:A.landSow,data:{landId:null==(i=this.data.parm)?void 0:i.landId,plantId:this.getDataList()[this.itemListSelectIndex].base.id,type:L.ApiTypeDefault}}).then(()=>{var e;f.inst.close(d.views.ShopView),(null==(e=this.data)?void 0:e.call)&&this.data.call(this.getDataList()[this.itemListSelectIndex])}).catch(()=>{this.canClick=!0});break;case"unlock_buy":case"ad_unlock":if(!this.canClick)return;this.canClick=!1,$.inst.send({api:A.seedsUnlock,data:{plantId:this.getDataList()[this.itemListSelectIndex].base.id,type:"ad_unlock"==t.target.name?L.ApiTypeAD:L.ApiTypeDefault}}).then(()=>{F.list[this.itemListSelectIndex].lock=!1,this.itemList.changeItem(this.itemListSelectIndex,F.list[this.itemListSelectIndex]),this.canClick=!0,"ad_unlock"==t.target.name&&S.eventGlobal.event(e.play_ad_get_reward,t.target)}).catch(()=>{this.canClick=!0});break;case"left":this.selectPetIndex--,this.selectPetIndex<0&&(this.selectPetIndex=M.list.length-1),this.updatePet();break;case"right":this.selectPetIndex++,this.selectPetIndex>=M.list.length&&(this.selectPetIndex=0),this.updatePet();break;case"pet_btn":this.petBuy();break;case"go_watch":this.petGoWatch(M.list[this.selectPetIndex].base.id);break;case"go_rest":this.petGoWatch(1001);break;case"feed_buy":this.feedBuy();break;case"withdraw_btn":this.withdraw()}}feedBuy(){let t=this.getDataList()[this.itemListSelectIndex];t&&this.canClick&&(this.canClick=!1,$.inst.send({api:A.feedBuy,data:{feedId:t.base.id,type:L.ApiTypeDefault}}).then(()=>{this.canClick=!0,E.petVitality+=t.base.vitality,S.eventGlobal.event(e.play_get_reward,{node:this.feedBuyBtn,list:[{obj:t.base,count:1,posType:2}],notFly:!0})}).catch(()=>{this.canClick=!0}))}petGoWatch(e){this.canClick&&(this.canClick=!1,$.inst.send({api:A.petWear,data:{petId:e,type:L.ApiTypeDefault}}).then(()=>{E.warePetId=e,this.canClick=!0,this.updatePet()}).catch(()=>{this.canClick=!0}))}petBuy(){let{base:e}=M.list[this.selectPetIndex];this.canClick&&(this.canClick=!1,$.inst.send({api:A.petBuy,data:{petId:e.id,type:L.ApiTypeDefault}}).then(()=>{this.canClick=!0,M.list[this.selectPetIndex].lock=!1,this.updatePet(),E.warePetId||(E.warePetId=e.id),E.petVitality||(E.petVitality=e.vitality_max,E.digestCountDown=L.petDigestIntervalTime)}).catch(()=>{this.canClick=!0}))}updateTopBtnState(){for(let e=0;e<this.btnBoxTop.numChildren;e++){let t=this.btnBoxTop.getChildAt(e),i=t.getChildAt(0);e===this.topBtnSelectIndex?(t.skin="game/img-menuselected.png",i.skin=this.btnTopResList[e][1]):(t.skin="game/img-menunormal.png",i.skin=this.btnTopResList[e][0])}this.updateBottom()}updateBottom(){for(let e=0;e<this.bottomBox.numChildren;e++)this.updateCenterBoxState(e,!1);let e=this.itemBuyBtn.parent;switch(this.topBtnSelectIndex){case 0:this.isFirst=!0,this.updateCenterBoxState(0,!0),this.resetPetOrFeedList(),this.feedBuyBtn.visible=!1,e.visible=!0,e.active=!0;break;case 1:this.updateCenterBoxState(1,!0),this.updatePet();break;case 2:this.isFirst=!0,this.updateCenterBoxState(0,!0),this.resetPetOrFeedList(),this.feedBuyBtn.visible=!0,e.visible=!1,e.active=!1;break;case 3:this.updateCenterBoxState(2,!0),this.priceList.array=this.priceDataList}}updatePet(){M.list.length||M.init([]);let e=M.list[this.selectPetIndex];this.petIcon.skin=e.base.icon,this.petName.text=e.base.name,this.petDesc.text=e.base.desc,this.vitalityMax.value=e.base.vitality_max+"";let t=this.petBuyBtn.getChildByName("btn_box");t.getChildByName("icon").skin=e.base.cost.obj.icon,t.getChildByName("value").value=e.base.cost.count+"";let i,s=this.bottomBox.getChildAt(1),a=s.getChildByName("find_box"),n=s.getChildByName("back_box");for(let t=0;t<5;t++)(i=a.getChildAt(t)).visible=20*t<e.base.sensitive,i.skin=20*t+10<e.base.sensitive?"game/img_star.png":"game/img_halfstar.png",(i=n.getChildAt(t)).visible=20*t<e.base.ability,i.skin=20*t+10<e.base.ability?"game/img_star.png":"game/img_halfstar.png";e.lock?(this.petBuyBtn.visible=!0,this.goRest.visible=!1,this.goWatch.visible=!1):(E.warePetId==e.base.id?(1===M.getUnlockLen()||1001===E.warePetId?this.goRest.disabled=!0:this.goRest.disabled=!1,this.goRest.visible=!0,this.goWatch.visible=!1):(this.goWatch.visible=!0,this.goRest.visible=!1),this.petBuyBtn.visible=!1)}resetPetOrFeedList(){this.itemListSelectIndex=0,this.itemList.selectedIndex=0,this.itemList.array=this.getDataList(),this.itemList.refresh()}updateCenterBoxState(e,t){this.bottomBox.getChildAt(e).visible=t,this.bottomBox.getChildAt(e).active=t}onPriceSelect(e){this.priceSelectIndex=e}withdraw(){null!=this.priceSelectIndex?this.canClick&&(this.canClick=!1,$.inst.send({api:A.withdraw,data:{id:this.priceSelectIndex}}).then(e=>{this.canClick=!0,S.view.openHint({text:"提现成功",call:()=>{}}),E.withdraw=e.list,E.diamond=e.diamond,this.priceList.refresh()}).catch(()=>{this.canClick=!0})):S.view.openHint({text:"选择要提现的金额",call:()=>{}})}updatePriceItem(e,t){let i=this.priceDataList[t],s={id:0,times:0};const a=E.withdraw;for(let e=0;e<a.length;e++)if(a[e].id==t){s=a[e];break}if(e.getChildByName("value").text=i.price+"元",i.times){let t=i.times-s.times;e.getChildByName("times_box").visible=!0,e.getChildByName("times_box").getChildByName("times").text=`剩余${t<0?0:t}次`,t<=0&&(e.disabled=!0)}else e.getChildByName("times_box").visible=!1;this.priceList.selectedIndex===t?e.getChildByName("bg").skin="game/img_priceselected.png":e.getChildByName("bg").skin="game/img_pricenormal.png"}},he=class extends g{onOpened(){this.signInList.array=H.table("signIn").list,this.signInList.vScrollBarSkin=null,this.signInList.renderHandler=new Laya.Handler(this,this.updateItem),this.updateProgress()}updateProgress(){let e=E.speedUpTimes/L.ADSpeedUpTimes;e>1&&(e=1),this.signInProgressBar.width=977*e,this.signInProgressLb.text=E.signInDays+"",this.progressDesc.text=`今日签到进度（使用${E.speedUpTimes}/${L.ADSpeedUpTimes}次加速）`,this.finishIcon.visible=E.speedUpTimes>=L.ADSpeedUpTimes}updateItem(e,t){const i=e.getChildByName("bar"),s=H.table("signIn").list[t];let a=E.signInDays/s.days;a>1&&(a=1),i.width=502*a;const n=e.getChildByName("reward_box");n.getChildByName("icon").skin=s.reward.obj.icon,n.getChildByName("amount").text=`x${s.reward.count}`,e.getChildByName("sign_days").text=`签到${s.days}天`;let o="",l=e.getChildByName("get_btn");l.dataSource=s.id,s.id>E.signInId?(l.active=!0,l.visible=!1,n.y=103,o="game/img_done.png",E.signInDays>=s.days&&(E.signInId?s.id-E.signInId==1&&(o="game/img_get.png",l.visible=!0,n.y=57):s.id==H.table("signIn").list[0].id&&(o="game/img_get.png",l.visible=!0,n.y=57))):(o="game/img_received.png",l.active=!1,l.visible=!0,n.y=57),l.skin=o}onClick(t){switch(t.target.name){case"close":f.inst.close(d.views.SignInView);break;case"get_btn":const i=t.target.dataSource;$.inst.send({api:A.signInReward,data:{type:L.ApiTypeAD,signInId:i}}).then(()=>{E.signInId=i,this.signInList.refresh();let s=H.table("signIn").get(i).reward;S.eventGlobal.event(e.play_get_reward,{node:t.target,list:[{obj:s.obj,count:s.count,posType:s.obj.id==L.goldId?1:2}]})})}}},ue=class extends S.gameScript{constructor(){super(...arguments),this.canClick=!0}onOpened(e){this.call=e.call;let t=H.table("config").get("all_speed_up_time").value;this.timeLb.text=`${Math.ceil(t/60)}分钟`,this.timesLb.text=`今日剩余${E.advertiseTimes}次`,E.advertiseTimes<=0&&(this.speedUpBtn.disabled=!0)}onClick(t){switch(t.target.name){case"close":S.view.close(d.views.SpeedUpView);break;case"speed_up":if(!this.canClick)return;this.canClick=!1,$.inst.send({api:A.landSpeedUp,data:{type:L.ApiTypeAD}}).then(i=>{E.speedUpTimes=i.speedUpTimes,E.advertiseTimes=i.advertiseTimes,E.speedUpTimes==L.ADSpeedUpTimes&&E.signInDays++,S.view.close(d.views.SpeedUpView),S.eventGlobal.event(e.land_speed_up),S.eventGlobal.event(e.play_ad_get_reward,t.target),this.call&&this.call()})}}},pe=class extends g{constructor(){super(...arguments),this.taskList=null}onOpened(){this.updateTaskList(),this.taskList.renderHandler=new Laya.Handler(this,this.itemRender),this.taskList.vScrollBarSkin=null}updateTaskList(){this.taskList.array=P.getList()}itemRender(e,t){let i=P.list[t].base;const s=P.getTask(i.id);e.getChildByName("icon").skin=i.icon,e.getChildByName("title").text=i.title,e.getChildByName("desc").text=`${i.desc}(${((null==s?void 0:s.times)>i.times?i.times:null==s?void 0:s.times)||0}/${i.times})`;const a=e.getChildByName("reward");a.getChildByName("icon").skin=i.reward.obj.icon,a.getChildByName("amount").text="x"+i.reward.count;const n=e.getChildByName("go_run"),o={id:i.id,ok:!1};(null==s?void 0:s.receive)?(n.skin="game/img_tomarow.png",n.active=!1,n.disabled=!0):(n.active=!0,n.disabled=!1,(null==s?void 0:s.times)>=i.times?(n.skin="game/img_get.png",o.ok=!0):n.skin="game/img_done.png"),n.dataSource=o}onClick(t){switch(t.target.name){case"close":f.inst.close(d.views.TaskView);break;case"go_run":let i=t.target.dataSource;i.ok?$.inst.send({api:A.taskReward,data:{type:L.ApiTypeAD,taskId:i.id}}).then(()=>{const s=P.getTask(i.id);s.receive=1,i.ok=!1,Laya.timer.frameOnce(1,this,()=>{this.updateTaskList(),this.taskList.refresh(),S.eventGlobal.event(e.update_task)}),S.eventGlobal.event(e.play_get_reward,{node:t.target,list:[{obj:s.base.reward.obj,count:s.base.reward.count,posType:2}]})}):this.jump(i.id,t.target)}}jump(i,s){return l(this,null,function*(){switch(i){case 1001:yield B.runAppFunction({uri:t.ad,data:{},timestamp:Date.now()}),$.inst.send({api:A.ad,data:{}}).then(()=>{S.eventGlobal.event(e.play_ad_get_reward,s),this.taskList.refresh(),P.taskAddTimes(1001),P.taskAddTimes(1012)});break;case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:break;case 1008:S.view.close(d.views.TaskView),S.view.open(d.views.WarehouseView)}})}},me=class extends S.gameScript{constructor(){super(...arguments),this.itemList=null,this.itemName=null,this.itemDesc=null,this.itemIcon=null,this.itemSellCountLb=null,this.itemSellBox=null,this.itemSellGold=null,this.itemSellDiamond=null,this.sellBtn=null,this.sellAdBtn=null,this.empty_lb=null,this.dataList=[],this.selectItemIndex="0,0",this.selectItemSellCount=0,this.unitPriceGold=0,this.unitPriceDiamond=0,this.canClick=!0}onOpened(){S.audio.playSound(d.audios.dakaicangku)}onHdAwake(){this.itemList.renderHandler=new Laya.Handler(this,this.renderItemList),this.itemList.vScrollBarSkin=null,this.updateList(),this.updateDesc(null),this.itemSellGold.removeSelf(),this.itemSellDiamond.removeSelf(),this.itemSellCountLb.on(Laya.Event.INPUT,this,()=>{this.selectItemSellCount=Number(this.itemSellCountLb.text),this.selectItemSellCount<1&&(this.selectItemSellCount=1,this.itemSellCountLb.text="1"),this.selectItemSellCount>this.selectItemData.count&&(this.selectItemSellCount=this.selectItemData.count),this.updateSelectSellCount()})}updateList(){let e=0,t=0,i=!1;R.list.forEach(s=>{var a;this.dataList[t]||(this.dataList[t]=[]),this.dataList[t].push(s),s.base.id==(null==(a=this.selectItemData)?void 0:a.base.id)&&(i=!0),++e>2&&(e=0,t++)}),!i&&this.dataList.length&&(this.selectItemIndex="0,0",this.itemList.selectedIndex=0),this.itemList.array=this.dataList,this.empty_lb.visible=!this.dataList.length}renderItemList(e,t){let i=this.dataList[t];for(let s=0;s<3;s++){let a=e.getChildByName(`item_${s}`);if(i[s]){a.visible=!0,a.dataSource=`${t},${s}`;let e=a.getChildByName("icon");e.skin=i[s].base.icon,a.getChildByName("name").text=`${i[s].base.name}_${i[s].count}`,t==this.itemList.selectedIndex&&this.selectItemIndex==a.dataSource?(Laya.Tween.to(e,{y:0},150,null,null,null,!1),this.selectItemData=i[s],this.updateDesc(i[s])):56!=e.y&&Laya.Tween.to(e,{y:56},150)}else a.visible=!1}}onClick(t){switch(t.target.name){case"close":S.view.close(d.views.WarehouseView);break;case"item_0":case"item_1":case"item_2":this.selectItemIndex=t.target.dataSource,this.itemList.refresh();break;case"add":this.selectItemSellCount++,this.selectItemSellCount>this.selectItemData.count&&(this.selectItemSellCount=this.selectItemData.count),this.updateSelectSellCount();break;case"reduce":this.selectItemSellCount--,this.selectItemSellCount<1&&(this.selectItemSellCount=1),this.updateSelectSellCount();break;case"sellBtnAd":case"sellBtn":if(!this.canClick)return;{this.canClick=!1;let i=t.target.name,s=t.target;$.inst.send({api:A.warehouseSell,data:{id:this.selectItemData.base.id,amount:this.selectItemSellCount,type:"sellBtn"==i?L.ApiTypeDefault:L.ApiTypeAD}}).then(()=>{this.canClick=!0,R.reduceAmount(this.selectItemData.base.id,this.selectItemSellCount),this.dataList=[],this.updateList(),this.itemList.refresh(),this.dataList.length||this.updateDesc(null);let t=[];this.unitPriceGold&&t.push({obj:H.table("currency").get(L.goldId),count:this.selectItemSellCount*this.unitPriceGold*("sellBtnAd"==i?2:1),posType:1}),this.unitPriceDiamond&&t.push({obj:H.table("currency").get(L.diamondId),count:this.selectItemSellCount*this.unitPriceDiamond*("sellBtnAd"==i?2:1),posType:2}),"sellBtnAd"==i&&S.eventGlobal.event(e.play_ad_get_reward,s),S.eventGlobal.event(e.play_get_reward,{node:this.sellBtn,list:t,callBack:()=>{}})}).catch(()=>{this.canClick=!0})}}}updateDesc(e){if(!e)return void(this.itemIcon.parent.visible=!1);let t,i;this.itemIcon.parent.visible=!0,this.itemSellDiamond.removeSelf(),this.itemSellGold.removeSelf(),this.itemIcon.skin=e.base.icon,this.itemName.text=e.base.name,this.itemDesc.text=e.base.desc;for(let s=0;s<e.base.gain.length;s++)e.base.gain[s].count&&(e.base.gain[s].obj.id==L.goldId?(t=e.base.gain[s],this.itemSellGold.getChildByName("icon").skin=e.base.gain[s].obj.icon,this.itemSellBox.addChild(this.itemSellGold)):(i=e.base.gain[s],this.itemSellDiamond.getChildByName("icon").skin=e.base.gain[s].obj.icon,this.itemSellBox.addChild(this.itemSellDiamond)));this.selectItemSellCount=e.count,this.unitPriceGold=(null==t?void 0:t.count)||0,this.unitPriceDiamond=(null==i?void 0:i.count)||0,this.updateSelectSellCount()}updateSelectSellCount(){this.itemSellCountLb.text=this.selectItemSellCount+"",this.itemSellGold.getChildByName("price").text=this.selectItemSellCount*this.unitPriceGold+"",this.itemSellDiamond.getChildByName("price").text=this.selectItemSellCount*this.unitPriceDiamond+""}},ge=class{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("view/AboutView.ts",I),e("components/Button.ts",x),e("components/ViewShowAni.ts",v),e("view/AddLandView.ts",J),e("view/BuyVitalityView.ts",W),e("view/FieldLevelUpView.ts",X),e("view/FriendsDescView.ts",z),e("view/FriendsRewardView.ts",K),e("view/FriendsView.ts",Q),e("view/GuideView.ts",Y),e("view/HintView.ts",q),e("view/LoginView.ts",Z),e("view/MailDescView.ts",ee),e("view/MailView.ts",te),e("view/MainView.ts",ae),e("components/FigureAni.ts",ne),e("components/FieldComponent.ts",se),e("view/OrderView.ts",oe),e("view/OverView.ts",le),e("view/SettingView.ts",de),e("view/ShopView.ts",re),e("view/SignInView.ts",he),e("view/SpeedUpView.ts",ue),e("view/TaskView.ts",pe),e("view/WarehouseView.ts",me)}};ge.width=1080,ge.height=1920,ge.scaleMode="fixedwidth",ge.screenMode="none",ge.alignV="middle",ge.alignH="center",ge.startScene="scenes/views/MainView.scene",ge.sceneRoot="",ge.debug=!1,ge.stat=!1,ge.physicsDebug=!1,ge.exportSceneToJson=!0,ge.init();var ve=class{constructor(){window.Laya3D?Laya3D.init(ge.width,ge.height):Laya.init(ge.width,ge.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=ge.scaleMode,Laya.stage.screenMode=ge.screenMode,Laya.stage.alignV=ge.alignV,Laya.stage.alignH=ge.alignH,Laya.URL.exportSceneToJson=ge.exportSceneToJson,(ge.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),ge.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),ge.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.stage.bgColor="#ffffff","test"==b.debug&&ge.stat&&Laya.Stat.show(),Laya.ResourceVersion.enable("version-b582c4250d.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){return l(this,null,function*(){Config.customRenderID=[],D.init(),$.inst.init(L.baseUrl),S.eventGlobal.on(e.login_game,this,this.loginGame),Laya.SoundManager.useAudioMusic=!1,B.listenAppFunction(),yield new Promise(e=>{f.inst.open(d.views.LoginView,{showLoad:!1,parm:{call:t=>{this.initGameData(t),e(null)}},complete:e=>{Laya.timer.frameOnce(1,this,()=>{B.runAppFunction({uri:t.closeImage,data:{}})})}})}),this.loginGame()})}loginGame(){Laya.loader.load(d.scenes,Laya.Handler.create(this,()=>{console.log("ok"),S.audio.playMusic(d.audios.BGM,0),Laya.timer.frameOnce(1,this,()=>{Laya.View.hideLoadingPage(1e3),f.inst.open(ge.startScene)})}),Laya.Handler.create(this,t=>{u.event(e.load_progress,t)},null,!1))}initGameData(e){}};ve.customRenderID=[],new ve})();